(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))s(u);new MutationObserver(u=>{for(const l of u)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function o(u){const l={};return u.integrity&&(l.integrity=u.integrity),u.referrerpolicy&&(l.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?l.credentials="include":u.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(u){if(u.ep)return;u.ep=!0;const l=o(u);fetch(u.href,l)}})();var w={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(n,i){(function(o){var s=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},u=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},l=function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var r=e*e;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},m=function(e,t){var r=Math.abs(e),h=Math.abs(t);return r<3e3&&h<3e3?Math.sqrt(r*r+h*h):(r<h?(r=h,h=e/t):h=t/e,r*Math.sqrt(1+h*h))},p=function(){throw SyntaxError("Invalid Param")};function M(e,t){var r=Math.abs(e),h=Math.abs(t);return e===0?Math.log(h):t===0?Math.log(r):r<3e3&&h<3e3?Math.log(e*e+t*t)*.5:(e=e/2,t=t/2,.5*Math.log(e*e+t*t)+Math.LN2)}var P=function(e,t){var r={re:0,im:0};if(e==null)r.re=r.im=0;else if(t!==void 0)r.re=e,r.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)r.re=e.re,r.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return a.INFINITY;r.re=e.abs*Math.cos(e.arg),r.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return a.INFINITY;r.re=e.r*Math.cos(e.phi),r.im=e.r*Math.sin(e.phi)}else e.length===2?(r.re=e[0],r.im=e[1]):p();break;case"string":r.im=r.re=0;var h=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),d=1,v=0;h===null&&p();for(var f=0;f<h.length;f++){var I=h[f];I===" "||I==="	"||I===`
`||(I==="+"?d++:I==="-"?v++:I==="i"||I==="I"?(d+v===0&&p(),h[f+1]!==" "&&!isNaN(h[f+1])?(r.im+=parseFloat((v%2?"-":"")+h[f+1]),f++):r.im+=parseFloat((v%2?"-":"")+"1"),d=v=0):((d+v===0||isNaN(I))&&p(),h[f+1]==="i"||h[f+1]==="I"?(r.im+=parseFloat((v%2?"-":"")+I),f++):r.re+=parseFloat((v%2?"-":"")+I),d=v=0))}d+v>0&&p();break;case"number":r.im=0,r.re=e;break;default:p()}return isNaN(r.re)||isNaN(r.im),r};function a(e,t){if(!(this instanceof a))return new a(e,t);var r=P(e,t);this.re=r.re,this.im=r.im}a.prototype={re:0,im:0,sign:function(){var e=this.abs();return new a(this.re/e,this.im/e)},add:function(e,t){var r=new a(e,t);return this.isInfinite()&&r.isInfinite()?a.NAN:this.isInfinite()||r.isInfinite()?a.INFINITY:new a(this.re+r.re,this.im+r.im)},sub:function(e,t){var r=new a(e,t);return this.isInfinite()&&r.isInfinite()?a.NAN:this.isInfinite()||r.isInfinite()?a.INFINITY:new a(this.re-r.re,this.im-r.im)},mul:function(e,t){var r=new a(e,t);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?a.NAN:this.isInfinite()||r.isInfinite()?a.INFINITY:r.im===0&&this.im===0?new a(this.re*r.re,0):new a(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(e,t){var r=new a(e,t);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return a.NAN;if(this.isInfinite()||r.isZero())return a.INFINITY;if(this.isZero()||r.isInfinite())return a.ZERO;e=this.re,t=this.im;var h=r.re,d=r.im,v,f;return d===0?new a(e/h,t/h):Math.abs(h)<Math.abs(d)?(f=h/d,v=h*f+d,new a((e*f+t)/v,(t*f-e)/v)):(f=d/h,v=d*f+h,new a((e+t*f)/v,(t-e*f)/v))},pow:function(e,t){var r=new a(e,t);if(e=this.re,t=this.im,r.isZero())return a.ONE;if(r.im===0){if(t===0&&e>0)return new a(Math.pow(e,r.re),0);if(e===0)switch((r.re%4+4)%4){case 0:return new a(Math.pow(t,r.re),0);case 1:return new a(0,Math.pow(t,r.re));case 2:return new a(-Math.pow(t,r.re),0);case 3:return new a(0,-Math.pow(t,r.re))}}if(e===0&&t===0&&r.re>0&&r.im>=0)return a.ZERO;var h=Math.atan2(t,e),d=M(e,t);return e=Math.exp(r.re*d-r.im*h),t=r.im*d+r.re*h,new a(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e=this.re,t=this.im,r=this.abs(),h,d;if(e>=0){if(t===0)return new a(Math.sqrt(e),0);h=.5*Math.sqrt(2*(r+e))}else h=Math.abs(t)/Math.sqrt(2*(r-e));return e<=0?d=.5*Math.sqrt(2*(r-e)):d=Math.abs(t)/Math.sqrt(2*(r+e)),new a(h,t<0?-d:d)},exp:function(){var e=Math.exp(this.re);return this.im,new a(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new a(Math.expm1(e)*Math.cos(t)+l(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return new a(M(e,t),Math.atan2(t,e))},abs:function(){return m(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new a(Math.sin(e)*s(t),Math.cos(e)*u(t))},cos:function(){var e=this.re,t=this.im;return new a(Math.cos(e)*s(t),-Math.sin(e)*u(t))},tan:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)+s(t);return new a(Math.sin(e)/r,u(t)/r)},cot:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)-s(t);return new a(-Math.sin(e)/r,u(t)/r)},sec:function(){var e=this.re,t=this.im,r=.5*s(2*t)+.5*Math.cos(2*e);return new a(Math.cos(e)*s(t)/r,Math.sin(e)*u(t)/r)},csc:function(){var e=this.re,t=this.im,r=.5*s(2*t)-.5*Math.cos(2*e);return new a(Math.sin(e)*s(t)/r,-Math.cos(e)*u(t)/r)},asin:function(){var e=this.re,t=this.im,r=new a(t*t-e*e+1,-2*e*t).sqrt(),h=new a(r.re-t,r.im+e).log();return new a(h.im,-h.re)},acos:function(){var e=this.re,t=this.im,r=new a(t*t-e*e+1,-2*e*t).sqrt(),h=new a(r.re-t,r.im+e).log();return new a(Math.PI/2-h.im,h.re)},atan:function(){var e=this.re,t=this.im;if(e===0){if(t===1)return new a(0,1/0);if(t===-1)return new a(0,-1/0)}var r=e*e+(1-t)*(1-t),h=new a((1-t*t-e*e)/r,-2*e/r).log();return new a(-.5*h.im,.5*h.re)},acot:function(){var e=this.re,t=this.im;if(t===0)return new a(Math.atan2(1,e),0);var r=e*e+t*t;return r!==0?new a(e/r,-t/r).atan():new a(e!==0?e/0:0,t!==0?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new a(0,1/0);var r=e*e+t*t;return r!==0?new a(e/r,-t/r).acos():new a(e!==0?e/0:0,t!==0?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new a(Math.PI/2,1/0);var r=e*e+t*t;return r!==0?new a(e/r,-t/r).asin():new a(e!==0?e/0:0,t!==0?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new a(u(e)*Math.cos(t),s(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new a(s(e)*Math.cos(t),u(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,r=s(e)+Math.cos(t);return new a(u(e)/r,Math.sin(t)/r)},coth:function(){var e=2*this.re,t=2*this.im,r=s(e)-Math.cos(t);return new a(u(e)/r,-Math.sin(t)/r)},csch:function(){var e=this.re,t=this.im,r=Math.cos(2*t)-s(2*e);return new a(-2*u(e)*Math.cos(t)/r,2*s(e)*Math.sin(t)/r)},sech:function(){var e=this.re,t=this.im,r=Math.cos(2*t)+s(2*e);return new a(2*s(e)*Math.cos(t)/r,-2*u(e)*Math.sin(t)/r)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else{var t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){var e=this.re,t=this.im,r=e>1&&t===0,h=1-e,d=1+e,v=h*h+t*t,f=v!==0?new a((d*h-t*t)/v,(t*h+d*t)/v):new a(e!==-1?e/0:0,t!==0?t/0:0),I=f.re;return f.re=M(f.re,f.im)/2,f.im=Math.atan2(f.im,I)/2,r&&(f.im=-f.im),f},acoth:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new a(0,Math.PI/2);var r=e*e+t*t;return r!==0?new a(e/r,-t/r).atanh():new a(e!==0?e/0:0,t!==0?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(t===0)return new a(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var r=e*e+t*t;return r!==0?new a(e/r,-t/r).asinh():new a(e!==0?e/0:0,t!==0?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return a.INFINITY;var r=e*e+t*t;return r!==0?new a(e/r,-t/r).acosh():new a(e!==0?e/0:0,t!==0?-t/0:0).acosh()},inverse:function(){if(this.isZero())return a.INFINITY;if(this.isInfinite())return a.ZERO;var e=this.re,t=this.im,r=e*e+t*t;return new a(e/r,-t/r)},conjugate:function(){return new a(this.re,-this.im)},neg:function(){return new a(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new a(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new a(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new a(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var r=new a(e,t);return Math.abs(r.re-this.re)<=a.EPSILON&&Math.abs(r.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){var e=this.re,t=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<a.EPSILON&&(e=0),Math.abs(t)<a.EPSILON&&(t=0),t===0?r+e:(e!==0?(r+=e,r+=" ",t<0?(t=-t,r+="-"):r+="+",r+=" "):t<0&&(t=-t,r+="-"),t!==1&&(r+=t),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.INFINITY=new a(1/0,1/0),a.NAN=new a(NaN,NaN),a.EPSILON=1e-15,Object.defineProperty(a,"__esModule",{value:!0}),a.default=a,a.Complex=a,n.exports=a})()})(w);var b={},c={};Object.defineProperty(c,"__esModule",{value:!0});c.polarToRectangular=c.makeBoundedLinear=c.makeLinear=ee=c.sum=c.countMap=D=c.initializedArray=Q=c.count=B=c.zip=c.FIGURE_SPACE=c.NON_BREAKING_SPACE=c.dateIsValid=c.MIN_DATE=c.MAX_DATE=c.makePromise=c.filterMap=c.pick=c.pickAny=c.csvStringToArray=c.parseTimeT=c.parseIntX=c.parseFloatX=c.getAttribute=c.followPath=c.parseXml=c.testXml=g=c.sleep=c.assertClass=void 0;function ce(n,i,o="Assertion Failed."){const s=u=>{throw new Error(`${o}  Expected type:  ${i.name}.  Found type:  ${u}.`)};if(n===null)s("null");else if(typeof n!="object")s(typeof n);else if(!(n instanceof i))s(n.constructor.name);else return n;throw new Error("wtf")}c.assertClass=ce;function le(n){return new Promise(i=>setTimeout(i,n))}var g=c.sleep=le;function $(n){const o=new DOMParser().parseFromString(n,"application/xml");for(const s of Array.from(o.querySelectorAll("parsererror")))if(s instanceof HTMLElement)return{error:s};return{parsed:o}}c.testXml=$;function he(n){if(n!==void 0)return $(n)?.parsed?.documentElement}c.parseXml=he;function W(n,...i){for(const o of i){if(n===void 0)return;if(typeof o=="number")n=n.children[o];else{const s=n.getElementsByTagName(o);if(s.length!=1)return;n=s[0]}}return n}c.followPath=W;function fe(n,i,...o){if(i=W(i,...o),i!==void 0&&!!i.hasAttribute(n))return i.getAttribute(n)??void 0}c.getAttribute=fe;function U(n){if(n==null)return;const i=parseFloat(n);if(isFinite(i))return i}c.parseFloatX=U;function K(n){const i=U(n);if(i!==void 0)return i>Number.MAX_SAFE_INTEGER||i<Number.MIN_SAFE_INTEGER||i!=Math.floor(i)?void 0:i}c.parseIntX=K;function me(n){if(typeof n=="string"&&(n=K(n)),n!=null&&!(n<=0))return new Date(n*1e3)}c.parseTimeT=me;const de=n=>{const i=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,o=[[]];let s;for(;s=i.exec(n);)s[1].length&&s[1]!==","&&o.push([]),o[o.length-1].push(s[2]!==void 0?s[2].replace(/""/g,'"'):s[3]);return o};c.csvStringToArray=de;function pe(n){const i=n.values().next();if(!i.done)return i.value}c.pickAny=pe;function ve(n){return n[Math.random()*n.length|0]}c.pick=ve;function we(n,i){const o=[];return n.forEach((s,u)=>{const l=i(s,u);l!==void 0&&o.push(l)}),o}c.filterMap=we;function Me(){let n,i;return{promise:new Promise((s,u)=>{n=s,i=u}),resolve:n,reject:i}}c.makePromise=Me;c.MAX_DATE=new Date(864e13);c.MIN_DATE=new Date(-864e13);function be(n){return isFinite(n.getTime())}c.dateIsValid=be;c.NON_BREAKING_SPACE="\xA0";c.FIGURE_SPACE="\u2007";function*Ie(...n){const i=n.map(o=>o[Symbol.iterator]());for(;;){const o=i.map(s=>s.next());if(o.some(({done:s})=>s))break;yield o.map(({value:s})=>s)}}var B=c.zip=Ie;function*ge(n=0,i=1/0,o=1){for(let s=n;s<i;s+=o)yield s}var Q=c.count=ge;function J(n,i){const o=[];for(let s=0;s<n;s++)o.push(i(s));return o}var D=c.initializedArray=J;c.countMap=J;function Ne(n){return n.reduce((i,o)=>i+o,0)}var ee=c.sum=Ne;function Ee(n,i,o,s){const u=(s-i)/(o-n);return function(l){return(l-n)*u+i}}c.makeLinear=Ee;function ye(n,i,o,s){o<n&&([n,i,o,s]=[o,s,n,i]);const u=(s-i)/(o-n);return function(l){return l<=n?i:l>=o?s:(l-n)*u+i}}c.makeBoundedLinear=ye;function xe(n,i){return{x:Math.sin(i)*n,y:Math.cos(i)*n}}c.polarToRectangular=xe;Object.defineProperty(b,"__esModule",{value:!0});b.createElementFromHTML=b.getHashInfo=b.getAudioBalanceControl=b.getBlobFromCanvas=b.loadDateTimeLocal=x=b.getById=void 0;const te=c;function Ce(n,i){const o=document.getElementById(n);if(!o)throw new Error("Could not find element with id "+n+".  Expected type:  "+i.name);if(o instanceof i)return o;throw new Error("Element with id "+n+" has type "+o.constructor.name+".  Expected type:  "+i.name)}var x=b.getById=Ce;function Pe(n,i,o="milliseconds"){let s;switch(o){case"minutes":{s=i.getSeconds()*1e3+i.getMilliseconds();break}case"seconds":{s=i.getMilliseconds();break}case"milliseconds":{s=0;break}default:throw new Error("wtf")}n.valueAsNumber=+i-i.getTimezoneOffset()*6e4-s}b.loadDateTimeLocal=Pe;function Te(n){const{reject:i,resolve:o,promise:s}=(0,te.makePromise)();return n.toBlob(u=>{u?o(u):i(new Error("blob is null!"))}),s}b.getBlobFromCanvas=Te;function Le(n){const i=new AudioContext,o=i.createMediaElementSource(n),s=new StereoPannerNode(i,{pan:0});return o.connect(s).connect(i.destination),u=>{s.pan.value=u}}b.getAudioBalanceControl=Le;function Se(){const n=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(s=>{const u=s.split("=",2);if(u.length==2){const l=decodeURIComponent(u[0]),m=decodeURIComponent(u[1]);n.set(l,m)}}),n}b.getHashInfo=Se;function Fe(n,i){var o=document.createElement("div");return o.innerHTML=n.trim(),(0,te.assertClass)(o.firstChild,i,"createElementFromHTML:")}b.createElementFromHTML=Fe;function*ne(n,i=[]){if(n.length==0)yield i;else for(let o=0;o<n.length;o++){const s=n[o],u=[...i,s],l=[...n.slice(0,o),...n.slice(o+1)];yield*ne(l,u)}}function z(n,i){if(!(i instanceof Array))return n;if(n.length!=i.length)throw new Error("wtf");let o=1/0,s;for(const u of ne(n)){let l=0;for(const[m,p]of B(u,i))l+=m.sub(p).abs();l<o&&(o=l,s=u)}return s}const k=new w.exports.Complex(1),O={shortName:"Square Root",allWs(n,i){const o=n.sqrt(),s=[o,o.neg()];return z(s,i)},error(n,i){return n.pow(2).sub(i).abs()},branchPoints:[w.exports.Complex.ZERO],initialZ:new w.exports.Complex(4),showSimpleCut:!0},Ae={shortName:"Natural Log",allWs(n,i){function o(u,l){return u.add(0,l)}const s=n.log();return i?i.map(u=>{const l=u.im-s.im,m=Math.round(l/(Math.PI*2))*Math.PI*2;return o(s,m)}):[o(s,Math.PI*4),o(s,Math.PI*2),s,o(s,-Math.PI*2),o(s,-Math.PI*4)]},error(n,i){return n.exp().sub(i).abs()},branchPoints:[w.exports.Complex.ZERO],initialZ:w.exports.Complex.E,showSimpleCut:!0},Ve={shortName:"\u{1D498}\xB3-\u{1D49B}\u{1D498}-2 = 0",initialZ:w.exports.Complex.ZERO,branchPoints:[new w.exports.Complex(3),new w.exports.Complex({r:3,phi:Math.PI*2/3}),new w.exports.Complex({r:3,phi:Math.PI*4/3})],allWs(n,i){const o=k.sub(n.pow(3).div(27)).sqrt(),s=n.isZero()?k:n.div(n.pow(3).pow(1/3)),u=k.add(o).pow(1/3),l=s.mul(k.sub(o).pow(1/3)),m=u.add(l),p=u.sub(l).mul(0,.866025403785),M=u.add(l).mul(-.5),P=M.add(p),a=M.sub(p);return z([m,P,a],i)},error(n,i){return n.pow(3).sub(i.mul(n)).sub(2).abs()},showSimpleCut:!1},V=[O,Ae,Ve],q=x("formula",HTMLSelectElement);V.forEach(n=>{const i=document.createElement("option");i.innerText=n.shortName,q.appendChild(i)});const re=x("bottom",SVGGElement),ie=x("main",SVGGElement),_=x("top",SVGGElement),se=x("positionInfo",HTMLDivElement),ke=x("errorInfo",HTMLDivElement),G=new Intl.NumberFormat("en-US",{minimumSignificantDigits:4,maximumSignificantDigits:4});function Oe(n){const i=n.re,o=n.im;let s="";return(i|0)==i?s+=i:s+=G.format(i),o!=0&&(o>0&&(s+="+"),(o|0)==o?s+=o:s+=G.format(o),s+="\u{1D4F2}"),s}class X{constructor(i,o){this.color=i,this.#t=o,this.#n=o;const s=document.createElement("div");s.style.color=i,se.appendChild(s),this.#i=s,this.displayValue();const u=o.re,l=-o.im,m=document.createElementNS("http://www.w3.org/2000/svg","circle");m.cx.baseVal.value=u,m.cy.baseVal.value=l,m.r.baseVal.value=.2,m.style.setProperty("--base-color",i),_.appendChild(m),this.#r=m;const p=document.createElementNS("http://www.w3.org/2000/svg","rect"),M=.5;p.x.baseVal.value=u-M/2,p.y.baseVal.value=l-M/2,p.width.baseVal.value=M,p.height.baseVal.value=M,p.style.setProperty("--base-color",i),re.appendChild(p),this.newLine()}#r;#e;get lastSegment(){return this.#e}#t;get currentValue(){return this.#t}set currentValue(i){const o=i.re,s=-i.im,u=this.#e;u.x2.baseVal.value=o,u.y2.baseVal.value=s;const l=this.#r;l.cx.baseVal.value=o,l.cy.baseVal.value=s,this.#t=i,this.displayValue()}#n;undo(){this.currentValue=this.#n}get lastSaved(){return this.#n}#i;displayValue(){this.#i.innerText=Oe(this.#t)}newLine(){const i=this.#t,o=i.re,s=-i.im,u=document.createElementNS("http://www.w3.org/2000/svg","line");u.x1.baseVal.value=o,u.y1.baseVal.value=s,u.x2.baseVal.value=o,u.y2.baseVal.value=s,u.setAttribute("stroke",this.color),u.classList.add("active"),this.#e?.classList?.remove("active"),ie.appendChild(u),this.#e=u,this.#n=i}save(){this.#t.equals(this.#n)||(this.#e&&this.#e.classList.add("can-be-styled"),this.newLine())}}let N,y,L,E;const S=x("showCut",HTMLInputElement);function ae(){E&&(E.style.display=S.checked?"":"none")}S.addEventListener("click",()=>{ae()});function oe(){if(E){const n=15*Math.SQRT2,o=N.branchPoints[0].sub(y.lastSaved).arg(),s=new w.exports.Complex({r:n,phi:o});E.x2.baseVal.value=s.re,E.y2.baseVal.value=-s.im}}function T(n){re.innerHTML="",ie.innerHTML="",_.innerHTML="",E=void 0,se.innerHTML="",n?(N=n,q.selectedIndex=V.indexOf(n)):N=V[q.selectedIndex];const i=N.initialZ;y=new X("black",i);const o=N.allWs(i);if(L=o.map((s,u)=>{const l=`hsl(${u/o.length}turn, 100%, 50%)`;return new X(l,s)}),N.showSimpleCut){S.disabled=!1,E=document.createElementNS("http://www.w3.org/2000/svg","line"),E.classList.add("cut-ray");const s=N.branchPoints[0];E.x1.baseVal.value=s.re,E.y1.baseVal.value=-s.im,oe(),ae(),_.appendChild(E)}else S.disabled=!0;ue();for(const s of N.branchPoints){const u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.classList.add("branch-point"),u.cx.baseVal.value=s.re,u.cy.baseVal.value=-s.im,u.r.baseVal.value=.1,_.appendChild(u)}}T();q.addEventListener("change",()=>{T()});x("reset",HTMLButtonElement).addEventListener("click",()=>T(N));function ue(){const n=y.currentValue,i=ee(L.map(o=>N.error(o.currentValue,n)));ke.innerText=`Total error = ${i}`}function C(n){y.currentValue=n;for(const[i,o]of B(N.allWs(n,L.map(s=>s.lastSaved)),L))o.currentValue=i;ue()}const F=document.querySelector("svg"),H=F.createSVGPoint();function _e(n){H.x=n.clientX,H.y=n.clientY;const i=H.matrixTransform(F.getScreenCTM().inverse());return new w.exports.Complex(i.x,-i.y)}function A(){y.save(),oe(),L.forEach(n=>n.save())}F.addEventListener("mouseleave",()=>{y.undo(),L.forEach(n=>n.undo())});F.addEventListener("mousemove",n=>{C(_e(n)),n.buttons&1&&A()});F.addEventListener("mouseup",n=>{A()});function R(n){switch(typeof n){case"number":{const i=V[n];if(!i)throw new Error(`No such formula: ${n}`);T(i);break}case"object":{T(n);break}case"string":{const i=V.find(o=>o.shortName==n);if(!i)throw new Error(`No such formula: "${n}"`);T(i);break}}}const Re={shortName:"Sixth Root",allWs(n,i){const s=n.pow(.16666666666666666),u=D(6,l=>s.mul({r:1,phi:Math.PI*2/6*l}));return z(u,i)},error(n,i){return n.pow(6).sub(i).abs()},branchPoints:[w.exports.Complex.ZERO],initialZ:new w.exports.Complex(6),showSimpleCut:!0};function j(n,i,o){const s=i.sub(n),u=new w.exports.Complex({r:1,phi:2*Math.PI/o}),l=D(Math.abs(o)-1,m=>u.pow(m+1).mul(s).add(n));return l.push(i),l}function Y(n,i,o){const s=i.sub(n);return D(o,u=>i.sub(s.mul((o-u-1)/o)))}function Ze(n){return new w.exports.Complex({re:-n.im,im:n.re})}function Z(n){Array.from(F.querySelectorAll(".can-be-styled")).forEach(i=>{const o=i.classList;o.remove("can-be-styled"),o.add(n)})}["thin","fat"].forEach(n=>{x(n,HTMLButtonElement).addEventListener("click",()=>{Z(n)})});async function qe(){S.checked=!1,R(O),await g(100);const n=30;for(const u of j(w.exports.Complex.ZERO,y.lastSaved,n))C(u),await g(3e3/n),A();Z("fat"),await g(500);for(const u of j(w.exports.Complex.ZERO,y.lastSaved,n))C(u),A(),await g(3e3/n);await g(2e3),R(O);async function i(u,l=Math.floor(50/u),m=3e3){const p=u*l;let M=y.lastSaved;for(let P=0;P<4;P++){const a=Ze(M);for(const[e,t]of B(Y(M,a,p),Q()))C(e),await g(m/p),(t+1)%l==0&&A();M=a}}await i(1),Z("thin"),await g(500),await i(2),Z("fat"),await g(500),await i(30),await g(500),S.checked=!0,R(O);for(const u of Y(y.lastSaved,new w.exports.Complex(-4,1),50))C(u),await g(3e3/50);const o=performance.now();function s(u){{const m=(u-o)/3e3*2*Math.PI,p=new w.exports.Complex({re:-4,im:Math.cos(m)});C(p),requestAnimationFrame(s)}}requestAnimationFrame(s)}window.phil={updateZ(n,i){C(new w.exports.Complex(n,i))},selectFormula:R,sixthRootFormula:Re,demo:qe};
