(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))s(u);new MutationObserver(u=>{for(const c of u)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(u){const c={};return u.integrity&&(c.integrity=u.integrity),u.referrerpolicy&&(c.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?c.credentials="include":u.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(u){if(u.ep)return;u.ep=!0;const c=a(u);fetch(u.href,c)}})();var f={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(t,r){(function(a){var s=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},u=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},c=function(e){var n=Math.PI/4;if(-n>e||e>n)return Math.cos(e)-1;var i=e*e;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},d=function(e,n){var i=Math.abs(e),h=Math.abs(n);return i<3e3&&h<3e3?Math.sqrt(i*i+h*h):(i<h?(i=h,h=e/n):h=n/e,i*Math.sqrt(1+h*h))},p=function(){throw SyntaxError("Invalid Param")};function M(e,n){var i=Math.abs(e),h=Math.abs(n);return e===0?Math.log(h):n===0?Math.log(i):i<3e3&&h<3e3?Math.log(e*e+n*n)*.5:(e=e/2,n=n/2,.5*Math.log(e*e+n*n)+Math.LN2)}var F=function(e,n){var i={re:0,im:0};if(e==null)i.re=i.im=0;else if(n!==void 0)i.re=e,i.im=n;else switch(typeof e){case"object":if("im"in e&&"re"in e)i.re=e.re,i.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return o.INFINITY;i.re=e.abs*Math.cos(e.arg),i.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return o.INFINITY;i.re=e.r*Math.cos(e.phi),i.im=e.r*Math.sin(e.phi)}else e.length===2?(i.re=e[0],i.im=e[1]):p();break;case"string":i.im=i.re=0;var h=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),w=1,v=0;h===null&&p();for(var m=0;m<h.length;m++){var E=h[m];E===" "||E==="	"||E===`
`||(E==="+"?w++:E==="-"?v++:E==="i"||E==="I"?(w+v===0&&p(),h[m+1]!==" "&&!isNaN(h[m+1])?(i.im+=parseFloat((v%2?"-":"")+h[m+1]),m++):i.im+=parseFloat((v%2?"-":"")+"1"),w=v=0):((w+v===0||isNaN(E))&&p(),h[m+1]==="i"||h[m+1]==="I"?(i.im+=parseFloat((v%2?"-":"")+E),m++):i.re+=parseFloat((v%2?"-":"")+E),w=v=0))}w+v>0&&p();break;case"number":i.im=0,i.re=e;break;default:p()}return isNaN(i.re)||isNaN(i.im),i};function o(e,n){if(!(this instanceof o))return new o(e,n);var i=F(e,n);this.re=i.re,this.im=i.im}o.prototype={re:0,im:0,sign:function(){var e=this.abs();return new o(this.re/e,this.im/e)},add:function(e,n){var i=new o(e,n);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re+i.re,this.im+i.im)},sub:function(e,n){var i=new o(e,n);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re-i.re,this.im-i.im)},mul:function(e,n){var i=new o(e,n);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:i.im===0&&this.im===0?new o(this.re*i.re,0):new o(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(e,n){var i=new o(e,n);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return o.NAN;if(this.isInfinite()||i.isZero())return o.INFINITY;if(this.isZero()||i.isInfinite())return o.ZERO;e=this.re,n=this.im;var h=i.re,w=i.im,v,m;return w===0?new o(e/h,n/h):Math.abs(h)<Math.abs(w)?(m=h/w,v=h*m+w,new o((e*m+n)/v,(n*m-e)/v)):(m=w/h,v=w*m+h,new o((e+n*m)/v,(n-e*m)/v))},pow:function(e,n){var i=new o(e,n);if(e=this.re,n=this.im,i.isZero())return o.ONE;if(i.im===0){if(n===0&&e>0)return new o(Math.pow(e,i.re),0);if(e===0)switch((i.re%4+4)%4){case 0:return new o(Math.pow(n,i.re),0);case 1:return new o(0,Math.pow(n,i.re));case 2:return new o(-Math.pow(n,i.re),0);case 3:return new o(0,-Math.pow(n,i.re))}}if(e===0&&n===0&&i.re>0&&i.im>=0)return o.ZERO;var h=Math.atan2(n,e),w=M(e,n);return e=Math.exp(i.re*w-i.im*h),n=i.im*w+i.re*h,new o(e*Math.cos(n),e*Math.sin(n))},sqrt:function(){var e=this.re,n=this.im,i=this.abs(),h,w;if(e>=0){if(n===0)return new o(Math.sqrt(e),0);h=.5*Math.sqrt(2*(i+e))}else h=Math.abs(n)/Math.sqrt(2*(i-e));return e<=0?w=.5*Math.sqrt(2*(i-e)):w=Math.abs(n)/Math.sqrt(2*(i+e)),new o(h,n<0?-w:w)},exp:function(){var e=Math.exp(this.re);return this.im,new o(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,n=this.im;return new o(Math.expm1(e)*Math.cos(n)+c(n),Math.exp(e)*Math.sin(n))},log:function(){var e=this.re,n=this.im;return new o(M(e,n),Math.atan2(n,e))},abs:function(){return d(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,n=this.im;return new o(Math.sin(e)*s(n),Math.cos(e)*u(n))},cos:function(){var e=this.re,n=this.im;return new o(Math.cos(e)*s(n),-Math.sin(e)*u(n))},tan:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)+s(n);return new o(Math.sin(e)/i,u(n)/i)},cot:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)-s(n);return new o(-Math.sin(e)/i,u(n)/i)},sec:function(){var e=this.re,n=this.im,i=.5*s(2*n)+.5*Math.cos(2*e);return new o(Math.cos(e)*s(n)/i,Math.sin(e)*u(n)/i)},csc:function(){var e=this.re,n=this.im,i=.5*s(2*n)-.5*Math.cos(2*e);return new o(Math.sin(e)*s(n)/i,-Math.cos(e)*u(n)/i)},asin:function(){var e=this.re,n=this.im,i=new o(n*n-e*e+1,-2*e*n).sqrt(),h=new o(i.re-n,i.im+e).log();return new o(h.im,-h.re)},acos:function(){var e=this.re,n=this.im,i=new o(n*n-e*e+1,-2*e*n).sqrt(),h=new o(i.re-n,i.im+e).log();return new o(Math.PI/2-h.im,h.re)},atan:function(){var e=this.re,n=this.im;if(e===0){if(n===1)return new o(0,1/0);if(n===-1)return new o(0,-1/0)}var i=e*e+(1-n)*(1-n),h=new o((1-n*n-e*e)/i,-2*e/i).log();return new o(-.5*h.im,.5*h.re)},acot:function(){var e=this.re,n=this.im;if(n===0)return new o(Math.atan2(1,e),0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).atan():new o(e!==0?e/0:0,n!==0?-n/0:0).atan()},asec:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new o(0,1/0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).acos():new o(e!==0?e/0:0,n!==0?-n/0:0).acos()},acsc:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new o(Math.PI/2,1/0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).asin():new o(e!==0?e/0:0,n!==0?-n/0:0).asin()},sinh:function(){var e=this.re,n=this.im;return new o(u(e)*Math.cos(n),s(e)*Math.sin(n))},cosh:function(){var e=this.re,n=this.im;return new o(s(e)*Math.cos(n),u(e)*Math.sin(n))},tanh:function(){var e=2*this.re,n=2*this.im,i=s(e)+Math.cos(n);return new o(u(e)/i,Math.sin(n)/i)},coth:function(){var e=2*this.re,n=2*this.im,i=s(e)-Math.cos(n);return new o(u(e)/i,-Math.sin(n)/i)},csch:function(){var e=this.re,n=this.im,i=Math.cos(2*n)-s(2*e);return new o(-2*u(e)*Math.cos(n)/i,2*s(e)*Math.sin(n)/i)},sech:function(){var e=this.re,n=this.im,i=Math.cos(2*n)+s(2*e);return new o(2*s(e)*Math.cos(n)/i,-2*u(e)*Math.sin(n)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var n=this.asin();return this.re=-this.im,this.im=e,e=n.re,n.re=-n.im,n.im=e,n},acosh:function(){var e=this.acos();if(e.im<=0){var n=e.re;e.re=-e.im,e.im=n}else{var n=e.im;e.im=-e.re,e.re=n}return e},atanh:function(){var e=this.re,n=this.im,i=e>1&&n===0,h=1-e,w=1+e,v=h*h+n*n,m=v!==0?new o((w*h-n*n)/v,(n*h+w*n)/v):new o(e!==-1?e/0:0,n!==0?n/0:0),E=m.re;return m.re=M(m.re,m.im)/2,m.im=Math.atan2(m.im,E)/2,i&&(m.im=-m.im),m},acoth:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new o(0,Math.PI/2);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).atanh():new o(e!==0?e/0:0,n!==0?-n/0:0).atanh()},acsch:function(){var e=this.re,n=this.im;if(n===0)return new o(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).asinh():new o(e!==0?e/0:0,n!==0?-n/0:0).asinh()},asech:function(){var e=this.re,n=this.im;if(this.isZero())return o.INFINITY;var i=e*e+n*n;return i!==0?new o(e/i,-n/i).acosh():new o(e!==0?e/0:0,n!==0?-n/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var e=this.re,n=this.im,i=e*e+n*n;return new o(e/i,-n/i)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new o(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new o(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new o(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,n){var i=new o(e,n);return Math.abs(i.re-this.re)<=o.EPSILON&&Math.abs(i.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var e=this.re,n=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<o.EPSILON&&(e=0),Math.abs(n)<o.EPSILON&&(n=0),n===0?i+e:(e!==0?(i+=e,i+=" ",n<0?(n=-n,i+="-"):i+="+",i+=" "):n<0&&(n=-n,i+="-"),n!==1&&(i+=n),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,t.exports=o})()})(f);var I={},l={};Object.defineProperty(l,"__esModule",{value:!0});l.polarToRectangular=l.makeBoundedLinear=oe=l.makeLinear=ae=l.sum=l.countMap=X=l.initializedArray=ie=l.count=G=l.zip=l.FIGURE_SPACE=l.NON_BREAKING_SPACE=l.dateIsValid=l.MIN_DATE=l.MAX_DATE=re=l.makePromise=l.filterMap=l.pick=l.pickAny=l.csvStringToArray=l.parseTimeT=l.parseIntX=l.parseFloatX=l.getAttribute=l.followPath=l.parseXml=l.testXml=N=l.sleep=l.assertClass=void 0;function ve(t,r,a="Assertion Failed."){const s=u=>{throw new Error(`${a}  Expected type:  ${r.name}.  Found type:  ${u}.`)};if(t===null)s("null");else if(typeof t!="object")s(typeof t);else if(!(t instanceof r))s(t.constructor.name);else return t;throw new Error("wtf")}l.assertClass=ve;function Me(t){return new Promise(r=>setTimeout(r,t))}var N=l.sleep=Me;function J(t){const a=new DOMParser().parseFromString(t,"application/xml");for(const s of Array.from(a.querySelectorAll("parsererror")))if(s instanceof HTMLElement)return{error:s};return{parsed:a}}l.testXml=J;function be(t){if(t!==void 0)return J(t)?.parsed?.documentElement}l.parseXml=be;function ee(t,...r){for(const a of r){if(t===void 0)return;if(typeof a=="number")t=t.children[a];else{const s=t.getElementsByTagName(a);if(s.length!=1)return;t=s[0]}}return t}l.followPath=ee;function xe(t,r,...a){if(r=ee(r,...a),r!==void 0&&!!r.hasAttribute(t))return r.getAttribute(t)??void 0}l.getAttribute=xe;function te(t){if(t==null)return;const r=parseFloat(t);if(isFinite(r))return r}l.parseFloatX=te;function ne(t){const r=te(t);if(r!==void 0)return r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER||r!=Math.floor(r)?void 0:r}l.parseIntX=ne;function ge(t){if(typeof t=="string"&&(t=ne(t)),t!=null&&!(t<=0))return new Date(t*1e3)}l.parseTimeT=ge;const Ie=t=>{const r=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,a=[[]];let s;for(;s=r.exec(t);)s[1].length&&s[1]!==","&&a.push([]),a[a.length-1].push(s[2]!==void 0?s[2].replace(/""/g,'"'):s[3]);return a};l.csvStringToArray=Ie;function Ee(t){const r=t.values().next();if(!r.done)return r.value}l.pickAny=Ee;function Ne(t){return t[Math.random()*t.length|0]}l.pick=Ne;function ye(t,r){const a=[];return t.forEach((s,u)=>{const c=r(s,u);c!==void 0&&a.push(c)}),a}l.filterMap=ye;function Ce(){let t,r;return{promise:new Promise((s,u)=>{t=s,r=u}),resolve:t,reject:r}}var re=l.makePromise=Ce;l.MAX_DATE=new Date(864e13);l.MIN_DATE=new Date(-864e13);function Pe(t){return isFinite(t.getTime())}l.dateIsValid=Pe;l.NON_BREAKING_SPACE="\xA0";l.FIGURE_SPACE="\u2007";function*Le(...t){const r=t.map(a=>a[Symbol.iterator]());for(;;){const a=r.map(s=>s.next());if(a.some(({done:s})=>s))break;yield a.map(({value:s})=>s)}}var G=l.zip=Le;function*Te(t=0,r=1/0,a=1){for(let s=t;s<r;s+=a)yield s}var ie=l.count=Te;function se(t,r){const a=[];for(let s=0;s<t;s++)a.push(r(s));return a}var X=l.initializedArray=se;l.countMap=se;function Se(t){return t.reduce((r,a)=>r+a,0)}var ae=l.sum=Se;function ke(t,r,a,s){const u=(s-r)/(a-t);return function(c){return(c-t)*u+r}}var oe=l.makeLinear=ke;function Ae(t,r,a,s){a<t&&([t,r,a,s]=[a,s,t,r]);const u=(s-r)/(a-t);return function(c){return c<=t?r:c>=a?s:(c-t)*u+r}}l.makeBoundedLinear=Ae;function Fe(t,r){return{x:Math.sin(r)*t,y:Math.cos(r)*t}}l.polarToRectangular=Fe;Object.defineProperty(I,"__esModule",{value:!0});I.createElementFromHTML=I.getHashInfo=I.getAudioBalanceControl=I.getBlobFromCanvas=I.loadDateTimeLocal=x=I.getById=void 0;const ue=l;function Ve(t,r){const a=document.getElementById(t);if(!a)throw new Error("Could not find element with id "+t+".  Expected type:  "+r.name);if(a instanceof r)return a;throw new Error("Element with id "+t+" has type "+a.constructor.name+".  Expected type:  "+r.name)}var x=I.getById=Ve;function De(t,r,a="milliseconds"){let s;switch(a){case"minutes":{s=r.getSeconds()*1e3+r.getMilliseconds();break}case"seconds":{s=r.getMilliseconds();break}case"milliseconds":{s=0;break}default:throw new Error("wtf")}t.valueAsNumber=+r-r.getTimezoneOffset()*6e4-s}I.loadDateTimeLocal=De;function Oe(t){const{reject:r,resolve:a,promise:s}=(0,ue.makePromise)();return t.toBlob(u=>{u?a(u):r(new Error("blob is null!"))}),s}I.getBlobFromCanvas=Oe;function Be(t){const r=new AudioContext,a=r.createMediaElementSource(t),s=new StereoPannerNode(r,{pan:0});return a.connect(s).connect(r.destination),u=>{s.pan.value=u}}I.getAudioBalanceControl=Be;function Re(){const t=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(s=>{const u=s.split("=",2);if(u.length==2){const c=decodeURIComponent(u[0]),d=decodeURIComponent(u[1]);t.set(c,d)}}),t}I.getHashInfo=Re;function _e(t,r){var a=document.createElement("div");return a.innerHTML=t.trim(),(0,ue.assertClass)(a.firstChild,r,"createElementFromHTML:")}I.createElementFromHTML=_e;function*ce(t,r=[]){if(t.length==0)yield r;else for(let a=0;a<t.length;a++){const s=t[a],u=[...r,s],c=[...t.slice(0,a),...t.slice(a+1)];yield*ce(c,u)}}function $(t,r){if(!(r instanceof Array))return t;if(t.length!=r.length)throw new Error("wtf");let a=1/0,s;for(const u of ce(t)){let c=0;for(const[d,p]of G(u,r))c+=d.sub(p).abs();c<a&&(a=c,s=u)}return s}const Z=new f.exports.Complex(1),T={shortName:"Square Root",allWs(t,r){const a=t.sqrt(),s=[a,a.neg()];return $(s,r)},error(t,r){return t.pow(2).sub(r).abs()},branchPoints:[f.exports.Complex.ZERO],initialZ:new f.exports.Complex(4),showSimpleCut:!0},Ze={shortName:"Natural Log",allWs(t,r){function a(u,c){return u.add(0,c)}const s=t.log();return r?r.map(u=>{const c=u.im-s.im,d=Math.round(c/(Math.PI*2))*Math.PI*2;return a(s,d)}):[a(s,Math.PI*4),a(s,Math.PI*2),s,a(s,-Math.PI*2),a(s,-Math.PI*4)]},error(t,r){return t.exp().sub(r).abs()},branchPoints:[f.exports.Complex.ZERO],initialZ:f.exports.Complex.E,showSimpleCut:!0},qe={shortName:"\u{1D498}\xB3-\u{1D49B}\u{1D498}-2 = 0",initialZ:f.exports.Complex.ZERO,branchPoints:[new f.exports.Complex(3),new f.exports.Complex({r:3,phi:Math.PI*2/3}),new f.exports.Complex({r:3,phi:Math.PI*4/3})],allWs(t,r){const a=Z.sub(t.pow(3).div(27)).sqrt(),s=t.isZero()?Z:t.div(t.pow(3).pow(1/3)),u=Z.add(a).pow(1/3),c=s.mul(Z.sub(a).pow(1/3)),d=u.add(c),p=u.sub(c).mul(0,.866025403785),M=u.add(c).mul(-.5),F=M.add(p),o=M.sub(p);return $([d,F,o],r)},error(t,r){return t.pow(3).sub(r.mul(t)).sub(2).abs()},showSimpleCut:!1},_=[T,Ze,qe],H=x("formula",HTMLSelectElement);_.forEach(t=>{const r=document.createElement("option");r.innerText=t.shortName,H.appendChild(r)});const le=x("bottom",SVGGElement),he=x("main",SVGGElement),q=x("top",SVGGElement),fe=x("positionInfo",HTMLDivElement),He=x("errorInfo",HTMLDivElement),W=new Intl.NumberFormat("en-US",{minimumSignificantDigits:4,maximumSignificantDigits:4});function ze(t){const r=t.re,a=t.im;let s="";return(r|0)==r?s+=r:s+=W.format(r),a!=0&&(a>0&&(s+="+"),(a|0)==a?s+=a:s+=W.format(a),s+="\u{1D4F2}"),s}class b{static#t=Array.from(document.querySelectorAll("button, select"));static#e;static now(){if(this.#e)throw new Error("Already disabled.");const r=[];this.#t.forEach(a=>{a.disabled||(a.disabled=!0,r.push(a))}),this.#e=r,Y()}static restore(){if(!this.#e)throw new Error("Already disabled.");this.#e.forEach(r=>r.disabled=!1),this.#e=void 0,Y()}static isEnabled(){return this.#e==null}static isDisabled(){return this.#e!=null}}class U{constructor(r,a){this.color=r,this.#n=a,this.#r=a;const s=document.createElement("div");s.style.color=r,fe.appendChild(s),this.#i=s,this.displayValue();const u=a.re,c=-a.im,d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.cx.baseVal.value=u,d.cy.baseVal.value=c,d.r.baseVal.value=.2,d.style.setProperty("--base-color",r),q.appendChild(d),this.#t=d;const p=document.createElementNS("http://www.w3.org/2000/svg","rect"),M=.5;p.x.baseVal.value=u-M/2,p.y.baseVal.value=c-M/2,p.width.baseVal.value=M,p.height.baseVal.value=M,p.style.setProperty("--base-color",r),le.appendChild(p),this.newLine()}#t;#e;get lastSegment(){return this.#e}#n;get currentValue(){return this.#n}set currentValue(r){const a=r.re,s=-r.im,u=this.#e;u.x2.baseVal.value=a,u.y2.baseVal.value=s;const c=this.#t;c.cx.baseVal.value=a,c.cy.baseVal.value=s,this.#n=r,this.displayValue()}#r;undo(){this.currentValue=this.#r}get lastSaved(){return this.#r}#i;displayValue(){this.#i.innerText=ze(this.#n)}newLine(){const r=this.#n,a=r.re,s=-r.im,u=document.createElementNS("http://www.w3.org/2000/svg","line");u.x1.baseVal.value=a,u.y1.baseVal.value=s,u.x2.baseVal.value=a,u.y2.baseVal.value=s,u.setAttribute("stroke",this.color),u.classList.add("active"),this.#e?.classList?.remove("active"),he.appendChild(u),this.#e=u,this.#r=r}save(){this.#n.equals(this.#r)||(this.#e&&this.#e.classList.add("can-be-styled"),this.newLine())}}let y,g,B,P;const L=x("showCut",HTMLInputElement);function Y(){L.disabled=b.isDisabled()||!y.showSimpleCut}function me(){P&&(P.style.display=L.checked?"":"none")}L.addEventListener("click",()=>{me()});function de(){if(P){const t=15*Math.SQRT2,a=y.branchPoints[0].sub(g.lastSaved).arg(),s=new f.exports.Complex({r:t,phi:a});P.x2.baseVal.value=s.re,P.y2.baseVal.value=-s.im}}function O(t){le.innerHTML="",he.innerHTML="",q.innerHTML="",P=void 0,fe.innerHTML="",t?(y=t,H.selectedIndex=_.indexOf(t)):y=_[H.selectedIndex];const r=y.initialZ;g=new U("black",r);const a=y.allWs(r);if(B=a.map((s,u)=>{const c=`hsl(${u/a.length}turn, 100%, 50%)`;return new U(c,s)}),y.showSimpleCut){P=document.createElementNS("http://www.w3.org/2000/svg","line"),P.classList.add("cut-ray");const s=y.branchPoints[0];P.x1.baseVal.value=s.re,P.y1.baseVal.value=-s.im,de(),me(),q.appendChild(P)}Y(),pe();for(const s of y.branchPoints){const u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.classList.add("branch-point"),u.cx.baseVal.value=s.re,u.cy.baseVal.value=-s.im,u.r.baseVal.value=.1,q.appendChild(u)}}O();H.addEventListener("change",()=>{O()});x("reset",HTMLButtonElement).addEventListener("click",()=>O(y));function pe(){const t=g.currentValue,r=ae(B.map(a=>y.error(a.currentValue,t)));He.innerText=`Total error = ${r}`}function C(t){g.currentValue=t;for(const[r,a]of G(y.allWs(t,B.map(s=>s.lastSaved)),B))a.currentValue=r;pe()}const R=document.querySelector("svg"),j=R.createSVGPoint();function Ge(t){j.x=t.clientX,j.y=t.clientY;const r=j.matrixTransform(R.getScreenCTM().inverse());return new f.exports.Complex(r.x,-r.y)}function V(){g.save(),de(),B.forEach(t=>t.save())}R.addEventListener("mouseleave",()=>{b.isDisabled()||(g.undo(),B.forEach(t=>t.undo()))});R.addEventListener("mousemove",t=>{b.isDisabled()||(C(Ge(t)),t.buttons&1&&V())});R.addEventListener("mouseup",t=>{b.isDisabled()||V()});function S(t){switch(typeof t){case"number":{const r=_[t];if(!r)throw new Error(`No such formula: ${t}`);O(r);break}case"object":{O(t);break}case"string":{const r=_.find(a=>a.shortName==t);if(!r)throw new Error(`No such formula: "${t}"`);O(r);break}}}const Xe={shortName:"Sixth Root",allWs(t,r){const s=t.pow(.16666666666666666),u=X(6,c=>s.mul({r:1,phi:Math.PI*2/6*c}));return $(u,r)},error(t,r){return t.pow(6).sub(r).abs()},branchPoints:[f.exports.Complex.ZERO],initialZ:new f.exports.Complex(6),showSimpleCut:!0};function K(t,r,a){const s=r.sub(t),u=new f.exports.Complex({r:1,phi:2*Math.PI/a}),c=X(Math.abs(a)-1,d=>u.pow(d+1).mul(s).add(t));return c.push(r),c}class z{constructor(r,a,s){this.center=r,this.steps=s,this.#t=a.sub(r)}#t;#e=0;getPosition(r){return r==1&&(r=0),this.#t.mul({r:1,phi:r*2*Math.PI}).add(this.center)}updateNow(r){const a=this.steps*r|0;for(;this.#e<a;)this.#e++,C(this.getPosition(this.#e/this.steps)),V();C(this.getPosition(r))}}function A(t,r){const a=re(),s=performance.now(),u=s+t,c=oe(s,0,u,1);let d=s;function p(M){try{M>=u?(r.updateNow(1),a.resolve()):(M>d&&r.updateNow(c(M)),requestAnimationFrame(p))}catch(F){a.reject(F)}}return requestAnimationFrame(p),a.promise}function Q(t,r,a){const s=r.sub(t);return X(a,u=>r.sub(s.mul((a-u-1)/a)))}class D{constructor(r,a,s){this.to=a,this.steps=s,this.#e=a.sub(r)}#t=0;#e;getPosition(r){return this.to.sub(this.#e.mul(1-r))}updateNow(r){if(this.steps){const a=this.steps*r|0;for(;this.#t<a;)this.#t++,C(this.getPosition(this.#t/this.steps)),V()}C(this.getPosition(r))}static makeDiamond(r,a=g.lastSaved){const s=[];for(let u=0;u<4;u++){const c=we(a);s.push(new this(a,c,r)),a=c}return s}}function we(t){return new f.exports.Complex({re:-t.im,im:t.re})}function k(t){Array.from(R.querySelectorAll(".can-be-styled")).forEach(r=>{const a=r.classList;a.remove("can-be-styled"),a.add(t)})}["thin","fat"].forEach(t=>{x(t,HTMLButtonElement).addEventListener("click",()=>{k(t)})});async function je(){L.checked=!1,S(T),await N(100);const t=30;for(const u of K(f.exports.Complex.ZERO,g.lastSaved,t))C(u),await N(3e3/t),V();k("fat"),await N(500);for(const u of K(f.exports.Complex.ZERO,g.lastSaved,t))C(u),V(),await N(3e3/t);await N(2e3),S(T);async function r(u,c=Math.floor(50/u),d=3e3){const p=u*c;let M=g.lastSaved;for(let F=0;F<4;F++){const o=we(M);for(const[e,n]of G(Q(M,o,p),ie()))C(e),await N(d/p),(n+1)%c==0&&V();M=o}}await r(1),k("thin"),await N(500),await r(2),k("fat"),await N(500),await r(30),await N(500),L.checked=!0,S(T);for(const u of Q(g.lastSaved,new f.exports.Complex(-4,1),50))C(u),await N(3e3/50);const a=performance.now();function s(u){{const d=(u-a)/3e3*2*Math.PI,p=new f.exports.Complex({re:-4,im:Math.cos(d)});C(p),requestAnimationFrame(s)}}requestAnimationFrame(s)}x("showMeCirclesAndRoots",HTMLButtonElement).addEventListener("click",async()=>{b.now(),L.checked=!1,S(T),await A(5e3,new z(f.exports.Complex.ZERO,g.lastSaved,20)),k("fat"),await N(500),await A(5e3,new z(f.exports.Complex.ZERO,g.lastSaved,20)),b.restore()});x("showMeBranchCuts1",HTMLButtonElement).addEventListener("click",async()=>{b.now(),L.checked=!0,S(T);let t=g.currentValue;const r=[[500,new f.exports.Complex(1,1)],[750,new f.exports.Complex(1,-1)],[750,new f.exports.Complex(1,1)],[750,new f.exports.Complex(1,-1)],[750,new f.exports.Complex(1,1)],[500,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[500,new f.exports.Complex(1,1)],[500,new f.exports.Complex(1,-1)],[500,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)]];for(const[a,s]of r)await A(a,new D(t,s,0)),t=s;b.restore()});x("showMeBranchCuts2",HTMLButtonElement).addEventListener("click",async()=>{b.now(),L.checked=!0,S(T);let t=new f.exports.Complex(-2,-2);C(t),V();const r=[[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)]];for(const[a,s]of r)await A(a,new D(t,s,5)),t=s;k("thin"),await A(5e3,new z(f.exports.Complex.ZERO,t,7)),k("fat"),await A(5e3,new z(f.exports.Complex.ZERO,t,35)),b.restore()});x("showMeSquare1",HTMLButtonElement).addEventListener("click",async()=>{b.now(),L.checked=!1,S(T);for(const t of D.makeDiamond(1))await A(1500,t);b.restore()});x("showMeSquare2",HTMLButtonElement).addEventListener("click",async()=>{b.now(),L.checked=!1,S(T);for(const t of D.makeDiamond(1))t.updateNow(1);k("thin");for(const t of D.makeDiamond(2))await A(1500,t);b.restore()});x("showMeSquare3",HTMLButtonElement).addEventListener("click",async()=>{b.now(),L.checked=!1,S(T);for(const t of D.makeDiamond(1))t.updateNow(1);k("thin");for(const t of D.makeDiamond(2))t.updateNow(1);k("fat");for(const t of D.makeDiamond(30))await A(1500,t);b.restore()});window.phil={updateZ(t,r){C(new f.exports.Complex(t,r))},selectFormula:S,sixthRootFormula:Xe,demo:je,DisableUserInterface:b};
