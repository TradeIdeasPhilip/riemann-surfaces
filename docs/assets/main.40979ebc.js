(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const w of u.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function o(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerpolicy&&(u.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?u.credentials="include":c.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(c){if(c.ep)return;c.ep=!0;const u=o(c);fetch(c.href,u)}})();var l={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(t,r){(function(o){var s=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},c=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},u=function(e){var n=Math.PI/4;if(-n>e||e>n)return Math.cos(e)-1;var i=e*e;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},w=function(e,n){var i=Math.abs(e),f=Math.abs(n);return i<3e3&&f<3e3?Math.sqrt(i*i+f*f):(i<f?(i=f,f=e/n):f=n/e,i*Math.sqrt(1+f*f))},d=function(){throw SyntaxError("Invalid Param")};function E(e,n){var i=Math.abs(e),f=Math.abs(n);return e===0?Math.log(f):n===0?Math.log(i):i<3e3&&f<3e3?Math.log(e*e+n*n)*.5:(e=e/2,n=n/2,.5*Math.log(e*e+n*n)+Math.LN2)}var D=function(e,n){var i={re:0,im:0};if(e==null)i.re=i.im=0;else if(n!==void 0)i.re=e,i.im=n;else switch(typeof e){case"object":if("im"in e&&"re"in e)i.re=e.re,i.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return a.INFINITY;i.re=e.abs*Math.cos(e.arg),i.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return a.INFINITY;i.re=e.r*Math.cos(e.phi),i.im=e.r*Math.sin(e.phi)}else e.length===2?(i.re=e[0],i.im=e[1]):d();break;case"string":i.im=i.re=0;var f=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),M=1,b=0;f===null&&d();for(var v=0;v<f.length;v++){var T=f[v];T===" "||T==="	"||T===`
`||(T==="+"?M++:T==="-"?b++:T==="i"||T==="I"?(M+b===0&&d(),f[v+1]!==" "&&!isNaN(f[v+1])?(i.im+=parseFloat((b%2?"-":"")+f[v+1]),v++):i.im+=parseFloat((b%2?"-":"")+"1"),M=b=0):((M+b===0||isNaN(T))&&d(),f[v+1]==="i"||f[v+1]==="I"?(i.im+=parseFloat((b%2?"-":"")+T),v++):i.re+=parseFloat((b%2?"-":"")+T),M=b=0))}M+b>0&&d();break;case"number":i.im=0,i.re=e;break;default:d()}return isNaN(i.re)||isNaN(i.im),i};function a(e,n){if(!(this instanceof a))return new a(e,n);var i=D(e,n);this.re=i.re,this.im=i.im}a.prototype={re:0,im:0,sign:function(){var e=this.abs();return new a(this.re/e,this.im/e)},add:function(e,n){var i=new a(e,n);return this.isInfinite()&&i.isInfinite()?a.NAN:this.isInfinite()||i.isInfinite()?a.INFINITY:new a(this.re+i.re,this.im+i.im)},sub:function(e,n){var i=new a(e,n);return this.isInfinite()&&i.isInfinite()?a.NAN:this.isInfinite()||i.isInfinite()?a.INFINITY:new a(this.re-i.re,this.im-i.im)},mul:function(e,n){var i=new a(e,n);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?a.NAN:this.isInfinite()||i.isInfinite()?a.INFINITY:i.im===0&&this.im===0?new a(this.re*i.re,0):new a(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(e,n){var i=new a(e,n);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return a.NAN;if(this.isInfinite()||i.isZero())return a.INFINITY;if(this.isZero()||i.isInfinite())return a.ZERO;e=this.re,n=this.im;var f=i.re,M=i.im,b,v;return M===0?new a(e/f,n/f):Math.abs(f)<Math.abs(M)?(v=f/M,b=f*v+M,new a((e*v+n)/b,(n*v-e)/b)):(v=M/f,b=M*v+f,new a((e+n*v)/b,(n-e*v)/b))},pow:function(e,n){var i=new a(e,n);if(e=this.re,n=this.im,i.isZero())return a.ONE;if(i.im===0){if(n===0&&e>0)return new a(Math.pow(e,i.re),0);if(e===0)switch((i.re%4+4)%4){case 0:return new a(Math.pow(n,i.re),0);case 1:return new a(0,Math.pow(n,i.re));case 2:return new a(-Math.pow(n,i.re),0);case 3:return new a(0,-Math.pow(n,i.re))}}if(e===0&&n===0&&i.re>0&&i.im>=0)return a.ZERO;var f=Math.atan2(n,e),M=E(e,n);return e=Math.exp(i.re*M-i.im*f),n=i.im*M+i.re*f,new a(e*Math.cos(n),e*Math.sin(n))},sqrt:function(){var e=this.re,n=this.im,i=this.abs(),f,M;if(e>=0){if(n===0)return new a(Math.sqrt(e),0);f=.5*Math.sqrt(2*(i+e))}else f=Math.abs(n)/Math.sqrt(2*(i-e));return e<=0?M=.5*Math.sqrt(2*(i-e)):M=Math.abs(n)/Math.sqrt(2*(i+e)),new a(f,n<0?-M:M)},exp:function(){var e=Math.exp(this.re);return this.im,new a(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,n=this.im;return new a(Math.expm1(e)*Math.cos(n)+u(n),Math.exp(e)*Math.sin(n))},log:function(){var e=this.re,n=this.im;return new a(E(e,n),Math.atan2(n,e))},abs:function(){return w(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,n=this.im;return new a(Math.sin(e)*s(n),Math.cos(e)*c(n))},cos:function(){var e=this.re,n=this.im;return new a(Math.cos(e)*s(n),-Math.sin(e)*c(n))},tan:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)+s(n);return new a(Math.sin(e)/i,c(n)/i)},cot:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)-s(n);return new a(-Math.sin(e)/i,c(n)/i)},sec:function(){var e=this.re,n=this.im,i=.5*s(2*n)+.5*Math.cos(2*e);return new a(Math.cos(e)*s(n)/i,Math.sin(e)*c(n)/i)},csc:function(){var e=this.re,n=this.im,i=.5*s(2*n)-.5*Math.cos(2*e);return new a(Math.sin(e)*s(n)/i,-Math.cos(e)*c(n)/i)},asin:function(){var e=this.re,n=this.im,i=new a(n*n-e*e+1,-2*e*n).sqrt(),f=new a(i.re-n,i.im+e).log();return new a(f.im,-f.re)},acos:function(){var e=this.re,n=this.im,i=new a(n*n-e*e+1,-2*e*n).sqrt(),f=new a(i.re-n,i.im+e).log();return new a(Math.PI/2-f.im,f.re)},atan:function(){var e=this.re,n=this.im;if(e===0){if(n===1)return new a(0,1/0);if(n===-1)return new a(0,-1/0)}var i=e*e+(1-n)*(1-n),f=new a((1-n*n-e*e)/i,-2*e/i).log();return new a(-.5*f.im,.5*f.re)},acot:function(){var e=this.re,n=this.im;if(n===0)return new a(Math.atan2(1,e),0);var i=e*e+n*n;return i!==0?new a(e/i,-n/i).atan():new a(e!==0?e/0:0,n!==0?-n/0:0).atan()},asec:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new a(0,1/0);var i=e*e+n*n;return i!==0?new a(e/i,-n/i).acos():new a(e!==0?e/0:0,n!==0?-n/0:0).acos()},acsc:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new a(Math.PI/2,1/0);var i=e*e+n*n;return i!==0?new a(e/i,-n/i).asin():new a(e!==0?e/0:0,n!==0?-n/0:0).asin()},sinh:function(){var e=this.re,n=this.im;return new a(c(e)*Math.cos(n),s(e)*Math.sin(n))},cosh:function(){var e=this.re,n=this.im;return new a(s(e)*Math.cos(n),c(e)*Math.sin(n))},tanh:function(){var e=2*this.re,n=2*this.im,i=s(e)+Math.cos(n);return new a(c(e)/i,Math.sin(n)/i)},coth:function(){var e=2*this.re,n=2*this.im,i=s(e)-Math.cos(n);return new a(c(e)/i,-Math.sin(n)/i)},csch:function(){var e=this.re,n=this.im,i=Math.cos(2*n)-s(2*e);return new a(-2*c(e)*Math.cos(n)/i,2*s(e)*Math.sin(n)/i)},sech:function(){var e=this.re,n=this.im,i=Math.cos(2*n)+s(2*e);return new a(2*s(e)*Math.cos(n)/i,-2*c(e)*Math.sin(n)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var n=this.asin();return this.re=-this.im,this.im=e,e=n.re,n.re=-n.im,n.im=e,n},acosh:function(){var e=this.acos();if(e.im<=0){var n=e.re;e.re=-e.im,e.im=n}else{var n=e.im;e.im=-e.re,e.re=n}return e},atanh:function(){var e=this.re,n=this.im,i=e>1&&n===0,f=1-e,M=1+e,b=f*f+n*n,v=b!==0?new a((M*f-n*n)/b,(n*f+M*n)/b):new a(e!==-1?e/0:0,n!==0?n/0:0),T=v.re;return v.re=E(v.re,v.im)/2,v.im=Math.atan2(v.im,T)/2,i&&(v.im=-v.im),v},acoth:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new a(0,Math.PI/2);var i=e*e+n*n;return i!==0?new a(e/i,-n/i).atanh():new a(e!==0?e/0:0,n!==0?-n/0:0).atanh()},acsch:function(){var e=this.re,n=this.im;if(n===0)return new a(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var i=e*e+n*n;return i!==0?new a(e/i,-n/i).asinh():new a(e!==0?e/0:0,n!==0?-n/0:0).asinh()},asech:function(){var e=this.re,n=this.im;if(this.isZero())return a.INFINITY;var i=e*e+n*n;return i!==0?new a(e/i,-n/i).acosh():new a(e!==0?e/0:0,n!==0?-n/0:0).acosh()},inverse:function(){if(this.isZero())return a.INFINITY;if(this.isInfinite())return a.ZERO;var e=this.re,n=this.im,i=e*e+n*n;return new a(e/i,-n/i)},conjugate:function(){return new a(this.re,-this.im)},neg:function(){return new a(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new a(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new a(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new a(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,n){var i=new a(e,n);return Math.abs(i.re-this.re)<=a.EPSILON&&Math.abs(i.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){var e=this.re,n=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<a.EPSILON&&(e=0),Math.abs(n)<a.EPSILON&&(n=0),n===0?i+e:(e!==0?(i+=e,i+=" ",n<0?(n=-n,i+="-"):i+="+",i+=" "):n<0&&(n=-n,i+="-"),n!==1&&(i+=n),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.INFINITY=new a(1/0,1/0),a.NAN=new a(NaN,NaN),a.EPSILON=1e-15,Object.defineProperty(a,"__esModule",{value:!0}),a.default=a,a.Complex=a,t.exports=a})()})(l);var N={},h={};Object.defineProperty(h,"__esModule",{value:!0});var ne=h.permutations=h.polarToRectangular=h.makeBoundedLinear=W=h.makeLinear=X=h.sum=h.countMap=le=h.initializedArray=h.count=$=h.zip=h.FIGURE_SPACE=h.NON_BREAKING_SPACE=h.dateIsValid=h.MIN_DATE=h.MAX_DATE=ae=h.makePromise=h.filterMap=h.pick=h.pickAny=h.csvStringToArray=h.parseTimeT=h.parseIntX=h.parseFloatX=h.getAttribute=h.followPath=h.parseXml=h.testXml=S=h.sleep=h.assertClass=void 0;function Ee(t,r,o="Assertion Failed."){const s=c=>{throw new Error(`${o}  Expected type:  ${r.name}.  Found type:  ${c}.`)};if(t===null)s("null");else if(typeof t!="object")s(typeof t);else if(!(t instanceof r))s(t.constructor.name);else return t;throw new Error("wtf")}h.assertClass=Ee;function ge(t){return new Promise(r=>setTimeout(r,t))}var S=h.sleep=ge;function re(t){const o=new DOMParser().parseFromString(t,"application/xml");for(const s of Array.from(o.querySelectorAll("parsererror")))if(s instanceof HTMLElement)return{error:s};return{parsed:o}}h.testXml=re;function Ce(t){if(t!==void 0)return re(t)?.parsed?.documentElement}h.parseXml=Ce;function ie(t,...r){for(const o of r){if(t===void 0)return;if(typeof o=="number")t=t.children[o];else{const s=t.getElementsByTagName(o);if(s.length!=1)return;t=s[0]}}return t}h.followPath=ie;function Ie(t,r,...o){if(r=ie(r,...o),r!==void 0&&!!r.hasAttribute(t))return r.getAttribute(t)??void 0}h.getAttribute=Ie;function se(t){if(t==null)return;const r=parseFloat(t);if(isFinite(r))return r}h.parseFloatX=se;function oe(t){const r=se(t);if(r!==void 0)return r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER||r!=Math.floor(r)?void 0:r}h.parseIntX=oe;function ye(t){if(typeof t=="string"&&(t=oe(t)),t!=null&&!(t<=0))return new Date(t*1e3)}h.parseTimeT=ye;const Ne=t=>{const r=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,o=[[]];let s;for(;s=r.exec(t);)s[1].length&&s[1]!==","&&o.push([]),o[o.length-1].push(s[2]!==void 0?s[2].replace(/""/g,'"'):s[3]);return o};h.csvStringToArray=Ne;function Le(t){const r=t.values().next();if(!r.done)return r.value}h.pickAny=Le;function Te(t){return t[Math.random()*t.length|0]}h.pick=Te;function ke(t,r){const o=[];return t.forEach((s,c)=>{const u=r(s,c);u!==void 0&&o.push(u)}),o}h.filterMap=ke;function Se(){let t,r;return{promise:new Promise((s,c)=>{t=s,r=c}),resolve:t,reject:r}}var ae=h.makePromise=Se;h.MAX_DATE=new Date(864e13);h.MIN_DATE=new Date(-864e13);function Pe(t){return isFinite(t.getTime())}h.dateIsValid=Pe;h.NON_BREAKING_SPACE="\xA0";h.FIGURE_SPACE="\u2007";function*Ae(...t){const r=t.map(o=>o[Symbol.iterator]());for(;;){const o=r.map(s=>s.next());if(o.some(({done:s})=>s))break;yield o.map(({value:s})=>s)}}var $=h.zip=Ae;function*Fe(t=0,r=1/0,o=1){for(let s=t;s<r;s+=o)yield s}h.count=Fe;function ce(t,r){const o=[];for(let s=0;s<t;s++)o.push(r(s));return o}var le=h.initializedArray=ce;h.countMap=ce;function Oe(t){return t.reduce((r,o)=>r+o,0)}var X=h.sum=Oe;function Re(t,r,o,s){const c=(s-r)/(o-t);return function(u){return(u-t)*c+r}}var W=h.makeLinear=Re;function Be(t,r,o,s){o<t&&([t,r,o,s]=[o,s,t,r]);const c=(s-r)/(o-t);return function(u){return u<=t?r:u>=o?s:(u-t)*c+r}}h.makeBoundedLinear=Be;function Ve(t,r){return{x:Math.sin(r)*t,y:Math.cos(r)*t}}h.polarToRectangular=Ve;function*ue(t,r=[]){if(t.length==0)yield r;else for(let o=0;o<t.length;o++){const s=t[o],c=[...r,s],u=[...t.slice(0,o),...t.slice(o+1)];yield*ue(u,c)}}ne=h.permutations=ue;Object.defineProperty(N,"__esModule",{value:!0});var he=N.download=N.createElementFromHTML=N.getHashInfo=N.getAudioBalanceControl=N.getBlobFromCanvas=N.loadDateTimeLocal=x=N.getById=void 0;const fe=h;function Ze(t,r){const o=document.getElementById(t);if(!o)throw new Error("Could not find element with id "+t+".  Expected type:  "+r.name);if(o instanceof r)return o;throw new Error("Element with id "+t+" has type "+o.constructor.name+".  Expected type:  "+r.name)}var x=N.getById=Ze;function De(t,r,o="milliseconds"){let s;switch(o){case"minutes":{s=r.getSeconds()*1e3+r.getMilliseconds();break}case"seconds":{s=r.getMilliseconds();break}case"milliseconds":{s=0;break}default:throw new Error("wtf")}t.valueAsNumber=+r-r.getTimezoneOffset()*6e4-s}N.loadDateTimeLocal=De;function He(t){const{reject:r,resolve:o,promise:s}=(0,fe.makePromise)();return t.toBlob(c=>{c?o(c):r(new Error("blob is null!"))}),s}N.getBlobFromCanvas=He;function _e(t){const r=new AudioContext,o=r.createMediaElementSource(t),s=new StereoPannerNode(r,{pan:0});return o.connect(s).connect(r.destination),c=>{s.pan.value=c}}N.getAudioBalanceControl=_e;function qe(){const t=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(s=>{const c=s.split("=",2);if(c.length==2){const u=decodeURIComponent(c[0]),w=decodeURIComponent(c[1]);t.set(u,w)}}),t}N.getHashInfo=qe;function ze(t,r){var o=document.createElement("div");return o.innerHTML=t.trim(),(0,fe.assertClass)(o.firstChild,r,"createElementFromHTML:")}N.createElementFromHTML=ze;function Ge(t,r){var o=document.createElement("a");if(o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(r)),o.setAttribute("download",t),document.createEvent){var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),o.dispatchEvent(s)}else o.click()}he=N.download=Ge;function K(t,r){if(!(r instanceof Array))return t;if(t.length!=r.length)throw new Error("wtf");let o=1/0,s;for(const c of ne(t)){let u=0;for(const[w,d]of $(c,r))u+=w.sub(d).abs();u<o&&(o=u,s=c)}return s}const q=new l.exports.Complex(1),A={shortName:"Square Root",allWs(t,r){const o=t.sqrt(),s=[o,o.neg()];return K(s,r)},error(t,r){return t.pow(2).sub(r).abs()},branchPoints:[l.exports.Complex.ZERO],initialZ:new l.exports.Complex(4),showSimpleCut:!0},Q={shortName:"Natural Log",allWs(t,r){function o(c,u){return c.add(0,u)}const s=t.log();return r?r.map(c=>{const u=c.im-s.im,w=Math.round(u/(Math.PI*2))*Math.PI*2;return o(s,w)}):[o(s,Math.PI*4),o(s,Math.PI*2),s,o(s,-Math.PI*2),o(s,-Math.PI*4)]},error(t,r){return t.exp().sub(r).abs()},branchPoints:[l.exports.Complex.ZERO],initialZ:l.exports.Complex.E,showSimpleCut:!0},j={shortName:"\u{1D498}\xB3-\u{1D49B}\u{1D498}-2 = 0",initialZ:l.exports.Complex.ZERO,branchPoints:[new l.exports.Complex(3),new l.exports.Complex({r:3,phi:Math.PI*2/3}),new l.exports.Complex({r:3,phi:Math.PI*4/3})],allWs(t,r){const o=q.sub(t.pow(3).div(27)).sqrt(),s=t.isZero()?q:t.div(t.pow(3).pow(1/3)),c=q.add(o).pow(1/3),u=s.mul(q.sub(o).pow(1/3)),w=c.add(u),d=c.sub(u).mul(0,.866025403785),E=c.add(u).mul(-.5),D=E.add(d),a=E.sub(d);return K([w,D,a],r)},error(t,r){return t.pow(3).sub(r.mul(t)).sub(2).abs()},showSimpleCut:!1},H=[A,Q,j],G=x("formula",HTMLSelectElement);H.forEach(t=>{const r=document.createElement("option");r.innerText=t.shortName,G.appendChild(r)});const me=x("bottom",SVGGElement),de=x("main",SVGGElement),z=x("top",SVGGElement),pe=x("positionInfo",HTMLDivElement),Xe=x("errorInfo",HTMLDivElement),J=new Intl.NumberFormat("en-US",{minimumSignificantDigits:4,maximumSignificantDigits:4});function je(t){const r=t.re,o=t.im;let s="";return(r|0)==r?s+=r:s+=J.format(r),o!=0&&(o>0&&(s+="+"),(o|0)==o?s+=o:s+=J.format(o),s+="\u{1D4F2}"),s}class p{static#t=Array.from(document.querySelectorAll("button:not([data-no-disable]), select"));static#e;static now(){if(this.#e)throw new Error("Already disabled.");const r=[];this.#t.forEach(o=>{o.disabled||(o.disabled=!0,r.push(o))}),this.#e=r,U()}static restore(){if(!this.#e)throw new Error("Already disabled.");this.#e.forEach(r=>r.disabled=!1),this.#e=void 0,U()}static isEnabled(){return this.#e==null}static isDisabled(){return this.#e!=null}}class ee{constructor(r,o){this.color=r,this.#n=o,this.#r=o;const s=document.createElement("div");s.style.color=r,pe.appendChild(s),this.#i=s,this.displayValue();const c=o.re,u=-o.im,w=document.createElementNS("http://www.w3.org/2000/svg","circle");w.cx.baseVal.value=c,w.cy.baseVal.value=u,w.r.baseVal.value=.2,w.style.setProperty("--base-color",r),z.appendChild(w),this.#t=w;const d=document.createElementNS("http://www.w3.org/2000/svg","rect"),E=.5;d.x.baseVal.value=c-E/2,d.y.baseVal.value=u-E/2,d.width.baseVal.value=E,d.height.baseVal.value=E,d.style.setProperty("--base-color",r),me.appendChild(d),this.newLine()}#t;#e;get lastSegment(){return this.#e}#n;get currentValue(){return this.#n}set currentValue(r){const o=r.re,s=-r.im,c=this.#e;c.x2.baseVal.value=o,c.y2.baseVal.value=s;const u=this.#t;u.cx.baseVal.value=o,u.cy.baseVal.value=s,this.#n=r,this.displayValue()}#r;undo(){this.currentValue=this.#r}get lastSaved(){return this.#r}#i;displayValue(){this.#i.innerText=je(this.#n)}newLine(){const r=this.#n,o=r.re,s=-r.im,c=document.createElementNS("http://www.w3.org/2000/svg","line");c.x1.baseVal.value=o,c.y1.baseVal.value=s,c.x2.baseVal.value=o,c.y2.baseVal.value=s,c.setAttribute("stroke",this.color),c.classList.add("active"),this.#e?.classList?.remove("active"),de.appendChild(c),this.#e=c,this.#r=r}save(){this.#n.equals(this.#r)||(this.#e&&this.#e.classList.add("can-be-styled"),this.newLine())}}let k,C,Z,P;const y=x("showCut",HTMLInputElement);function U(){y.disabled=p.isDisabled()||!k.showSimpleCut}function we(){P&&(P.style.display=y.checked?"":"none")}y.addEventListener("click",()=>{we()});function ve(){if(P){const t=15*Math.SQRT2,o=k.branchPoints[0].sub(C.lastSaved).arg(),s=new l.exports.Complex({r:t,phi:o});P.x2.baseVal.value=s.re,P.y2.baseVal.value=-s.im}}function V(t){me.innerHTML="",de.innerHTML="",z.innerHTML="",P=void 0,pe.innerHTML="",t?(k=t,G.selectedIndex=H.indexOf(t)):k=H[G.selectedIndex];const r=k.initialZ;C=new ee("black",r);const o=k.allWs(r);if(Z=o.map((s,c)=>{const u=`hsl(${c/o.length}turn, 100%, 50%)`;return new ee(u,s)}),k.showSimpleCut){P=document.createElementNS("http://www.w3.org/2000/svg","line"),P.classList.add("cut-ray");const s=k.branchPoints[0];P.x1.baseVal.value=s.re,P.y1.baseVal.value=-s.im,ve(),we(),z.appendChild(P)}U(),Me();for(const s of k.branchPoints){const c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.classList.add("branch-point"),c.cx.baseVal.value=s.re,c.cy.baseVal.value=-s.im,c.r.baseVal.value=.1,z.appendChild(c)}}V();G.addEventListener("change",()=>{V()});x("reset",HTMLButtonElement).addEventListener("click",()=>V(k));function Me(){const t=C.currentValue,r=X(Z.map(o=>k.error(o.currentValue,t)));Xe.innerText=`Total error = ${r}`}function F(t){C.currentValue=t;for(const[r,o]of $(k.allWs(t,Z.map(s=>s.lastSaved)),Z))o.currentValue=r;Me()}const B=document.querySelector("svg"),Y=B.createSVGPoint();function Ye(t){Y.x=t.clientX,Y.y=t.clientY;const r=Y.matrixTransform(B.getScreenCTM().inverse());return new l.exports.Complex(r.x,-r.y)}function _(){C.save(),ve(),Z.forEach(t=>t.save())}B.addEventListener("mouseleave",()=>{p.isDisabled()||(C.undo(),Z.forEach(t=>t.undo()))});B.addEventListener("mousemove",t=>{p.isDisabled()||(F(Ye(t)),t.buttons&1&&_())});B.addEventListener("mouseup",t=>{p.isDisabled()||_()});function L(t){switch(typeof t){case"number":{const r=H[t];if(!r)throw new Error(`No such formula: ${t}`);V(r);break}case"object":{V(t);break}case"string":{const r=H.find(o=>o.shortName==t);if(!r)throw new Error(`No such formula: "${t}"`);V(r);break}}}function xe(t){return new l.exports.Complex({r:1,phi:t})}function O(t){return xe(t*(Math.PI*2))}function te(t){return xe(t*(Math.PI/180))}const Ue={shortName:"Sixth Root",allWs(t,r){const s=t.pow(.16666666666666666),c=le(6,u=>s.mul(O(u/6)));return K(c,r)},error(t,r){return t.pow(6).sub(r).abs()},branchPoints:[l.exports.Complex.ZERO],initialZ:new l.exports.Complex(6),showSimpleCut:!0};class I{constructor(r,o,s){this.center=r,this.#t=o.sub(r),this.#n=s>0?1:-1,this.#r=s/this.#n}#t;#e=0;#n;#r;getPosition(r){return r==1&&(r=0),this.#t.mul(O(r*this.#n)).add(this.center)}updateNow(r){const o=this.#r*r|0;for(;this.#e<o;)this.#e++,F(this.getPosition(this.#e/this.#r)),_();F(this.getPosition(r))}}function m(t,r){const o=ae(),s=performance.now(),c=s+t,u=W(s,0,c,1);let w=s;function d(E){try{E>=c?(r.updateNow(1),o.resolve()):(E>w&&r.updateNow(u(E)),requestAnimationFrame(d))}catch(D){o.reject(D)}}return requestAnimationFrame(d),o.promise}class g{constructor(r,o,s){this.to=o,this.steps=s,this.#e=o.sub(r)}#t=0;#e;getPosition(r){return this.to.sub(this.#e.mul(1-r))}updateNow(r){if(this.steps){const o=this.steps*r|0;for(;this.#t<o;)this.#t++,F(this.getPosition(this.#t/this.steps)),_()}F(this.getPosition(r))}static makeDiamond(r,o=C.lastSaved){const s=[];for(let c=0;c<4;c++){const u=$e(o);s.push(new this(o,u,r)),o=u}return s}}function $e(t){return new l.exports.Complex({re:-t.im,im:t.re})}function R(t){Array.from(B.querySelectorAll(".can-be-styled")).forEach(r=>{const o=r.classList;o.remove("can-be-styled"),o.add(t)})}["thin","fat"].forEach(t=>{x(t,HTMLButtonElement).addEventListener("click",()=>{R(t)})});x("showMeCirclesAndRoots",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(A),await m(5e3,new I(l.exports.Complex.ZERO,C.lastSaved,20)),R("fat"),await S(500),await m(5e3,new I(l.exports.Complex.ZERO,C.lastSaved,20)),p.restore()});x("showMeBranchCuts1",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!0,L(A);let t=C.currentValue;const r=[[500,new l.exports.Complex(1,1)],[750,new l.exports.Complex(1,-1)],[750,new l.exports.Complex(1,1)],[750,new l.exports.Complex(1,-1)],[750,new l.exports.Complex(1,1)],[500,new l.exports.Complex(-2,2)],[750,new l.exports.Complex(-2,-2)],[750,new l.exports.Complex(-2,2)],[750,new l.exports.Complex(-2,-2)],[750,new l.exports.Complex(-2,2)],[500,new l.exports.Complex(1,1)],[500,new l.exports.Complex(1,-1)],[500,new l.exports.Complex(-2,-2)],[750,new l.exports.Complex(-2,2)],[750,new l.exports.Complex(-2,-2)],[750,new l.exports.Complex(-2,2)],[750,new l.exports.Complex(-2,-2)]];for(const[o,s]of r)await m(o,new g(t,s,0)),t=s;p.restore()});x("showMeBranchCuts2",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!0,L(A);let t=new l.exports.Complex(-2,-2);F(t),_();const r=[[750,new l.exports.Complex(-2,2)],[750,new l.exports.Complex(-2,-2)],[750,new l.exports.Complex(-2,2)],[750,new l.exports.Complex(-2,-2)]];for(const[o,s]of r)await m(o,new g(t,s,5)),t=s;R("thin"),await m(5e3,new I(l.exports.Complex.ZERO,t,7)),R("fat"),await m(5e3,new I(l.exports.Complex.ZERO,t,35)),p.restore()});x("showMeSquare1",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(A);for(const t of g.makeDiamond(1))await m(1500,t);p.restore()});x("showMeSquare2",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(A);for(const t of g.makeDiamond(1))t.updateNow(1);R("thin");for(const t of g.makeDiamond(2))await m(1500,t);p.restore()});x("showMeSquare3",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(A);for(const t of g.makeDiamond(1))t.updateNow(1);R("thin");for(const t of g.makeDiamond(2))t.updateNow(1);R("fat");for(const t of g.makeDiamond(30))await m(1500,t);p.restore()});x("showMeEquilateralTriangle",HTMLButtonElement).addEventListener("click",async()=>{const t=new l.exports.Complex(6.5),r=t.mul(O(1/3)),o=t.mul(O(2/3));p.now(),y.checked=!1,L(A),await m(250,new g(C.currentValue,t,1)),await m(2e3,new g(t,r,50)),await m(2e3,new g(r,o,50)),await m(2e3,new g(o,t,50)),p.restore()});x("showMeRightTriangle",HTMLButtonElement).addEventListener("click",async()=>{const r=6*Math.sqrt(3),o=2*6;p.now(),y.checked=!1,L(A);const s=C.lastSaved,c=s.add(te(90+45+20).mul(r)),u=s.add(te(180+45+20).mul(6)),w=6e3,d=X([6,r,o]);await m(w*r/d,new g(s,c,50)),await m(w*o/d,new g(c,u,50)),await m(w*6/d,new g(u,s,50)),p.restore()});x("showMeLog1",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(Q),await m(250,new g(C.lastSaved,new l.exports.Complex(2),1)),await m(2e3,new I(l.exports.Complex.ZERO,C.lastSaved,50)),await m(250,new g(C.lastSaved,new l.exports.Complex(4),1)),await m(4e3,new I(l.exports.Complex.ZERO,C.lastSaved,100)),await m(250,new g(C.lastSaved,new l.exports.Complex(6),1)),await m(6e3,new I(l.exports.Complex.ZERO,C.lastSaved,-150)),p.restore()});x("showMeLog2",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(Q);const t=W(0,1,1,-8);await m(5e3,{updateNow(o){const s=Math.exp(t(o));F(new l.exports.Complex(s))}}),p.restore()});x("showMeMultiple1",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(j);const t=new l.exports.Complex(2,0),r=t.mul(O(1/3)),o=t.mul(O(2/3));await S(500),await m(5e3,new I(t,l.exports.Complex.ZERO,50)),await S(500),await m(5e3,new I(r,l.exports.Complex.ZERO,50)),await S(500),await m(5e3,new I(o,l.exports.Complex.ZERO,50)),await S(500);const s=1.2;await m(5e3,new I(o.mul(s),l.exports.Complex.ZERO,50)),await S(500),await m(5e3,new I(r.mul(s),l.exports.Complex.ZERO,50)),await S(500),await m(5e3,new I(t.mul(s),l.exports.Complex.ZERO,50)),p.restore()});x("showMeMultiple2",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(j),await S(500);const t=[new l.exports.Complex(0,0),new l.exports.Complex(0,4),new l.exports.Complex(-3,4),new l.exports.Complex(-3,-4),new l.exports.Complex(0,-4)],r=t.map((u,w)=>{const d=t[(w+1)%t.length],E=d.sub(u).abs();return{from:u,to:d,length:E}}),o=X(r.map(u=>u.length)),s=1e4,c=5;for(const{to:u,from:w,length:d}of r){const E=Math.round(d*c);await m(s*d/o,new g(w,u,E))}p.restore()});x("showMeMultiple3",HTMLButtonElement).addEventListener("click",async()=>{p.now(),y.checked=!1,L(j);const t=new l.exports.Complex(1.5),r=.08;await S(500),await m(5e3,new I(t.add(r),l.exports.Complex.ZERO,50)),await S(500),await m(5e3,new I(t.sub(r),l.exports.Complex.ZERO,50)),await S(500),await m(5e3,new I(t.sub(r/2).mul(O(1/3)),l.exports.Complex.ZERO,50)),p.restore()});const be=x("saveChart",HTMLButtonElement);be.addEventListener("click",()=>{const t=B.outerHTML;he("chart.svg",t)});addEventListener("keydown",t=>{t.code=="KeyS"&&be.click()});window.phil={updateZ(t,r){F(new l.exports.Complex(t,r))},selectFormula:L,sixthRootFormula:Ue,DisableUserInterface:p};
