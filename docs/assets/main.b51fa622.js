(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))s(u);new MutationObserver(u=>{for(const c of u)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(u){const c={};return u.integrity&&(c.integrity=u.integrity),u.referrerpolicy&&(c.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?c.credentials="include":u.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(u){if(u.ep)return;u.ep=!0;const c=a(u);fetch(u.href,c)}})();var f={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(t,r){(function(a){var s=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},u=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},c=function(e){var n=Math.PI/4;if(-n>e||e>n)return Math.cos(e)-1;var i=e*e;return i*(i*(i*(i*(i*(i*(i*(i/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},d=function(e,n){var i=Math.abs(e),h=Math.abs(n);return i<3e3&&h<3e3?Math.sqrt(i*i+h*h):(i<h?(i=h,h=e/n):h=n/e,i*Math.sqrt(1+h*h))},p=function(){throw SyntaxError("Invalid Param")};function x(e,n){var i=Math.abs(e),h=Math.abs(n);return e===0?Math.log(h):n===0?Math.log(i):i<3e3&&h<3e3?Math.log(e*e+n*n)*.5:(e=e/2,n=n/2,.5*Math.log(e*e+n*n)+Math.LN2)}var B=function(e,n){var i={re:0,im:0};if(e==null)i.re=i.im=0;else if(n!==void 0)i.re=e,i.im=n;else switch(typeof e){case"object":if("im"in e&&"re"in e)i.re=e.re,i.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return o.INFINITY;i.re=e.abs*Math.cos(e.arg),i.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return o.INFINITY;i.re=e.r*Math.cos(e.phi),i.im=e.r*Math.sin(e.phi)}else e.length===2?(i.re=e[0],i.im=e[1]):p();break;case"string":i.im=i.re=0;var h=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),w=1,v=0;h===null&&p();for(var m=0;m<h.length;m++){var N=h[m];N===" "||N==="	"||N===`
`||(N==="+"?w++:N==="-"?v++:N==="i"||N==="I"?(w+v===0&&p(),h[m+1]!==" "&&!isNaN(h[m+1])?(i.im+=parseFloat((v%2?"-":"")+h[m+1]),m++):i.im+=parseFloat((v%2?"-":"")+"1"),w=v=0):((w+v===0||isNaN(N))&&p(),h[m+1]==="i"||h[m+1]==="I"?(i.im+=parseFloat((v%2?"-":"")+N),m++):i.re+=parseFloat((v%2?"-":"")+N),w=v=0))}w+v>0&&p();break;case"number":i.im=0,i.re=e;break;default:p()}return isNaN(i.re)||isNaN(i.im),i};function o(e,n){if(!(this instanceof o))return new o(e,n);var i=B(e,n);this.re=i.re,this.im=i.im}o.prototype={re:0,im:0,sign:function(){var e=this.abs();return new o(this.re/e,this.im/e)},add:function(e,n){var i=new o(e,n);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re+i.re,this.im+i.im)},sub:function(e,n){var i=new o(e,n);return this.isInfinite()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:new o(this.re-i.re,this.im-i.im)},mul:function(e,n){var i=new o(e,n);return this.isInfinite()&&i.isZero()||this.isZero()&&i.isInfinite()?o.NAN:this.isInfinite()||i.isInfinite()?o.INFINITY:i.im===0&&this.im===0?new o(this.re*i.re,0):new o(this.re*i.re-this.im*i.im,this.re*i.im+this.im*i.re)},div:function(e,n){var i=new o(e,n);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return o.NAN;if(this.isInfinite()||i.isZero())return o.INFINITY;if(this.isZero()||i.isInfinite())return o.ZERO;e=this.re,n=this.im;var h=i.re,w=i.im,v,m;return w===0?new o(e/h,n/h):Math.abs(h)<Math.abs(w)?(m=h/w,v=h*m+w,new o((e*m+n)/v,(n*m-e)/v)):(m=w/h,v=w*m+h,new o((e+n*m)/v,(n-e*m)/v))},pow:function(e,n){var i=new o(e,n);if(e=this.re,n=this.im,i.isZero())return o.ONE;if(i.im===0){if(n===0&&e>0)return new o(Math.pow(e,i.re),0);if(e===0)switch((i.re%4+4)%4){case 0:return new o(Math.pow(n,i.re),0);case 1:return new o(0,Math.pow(n,i.re));case 2:return new o(-Math.pow(n,i.re),0);case 3:return new o(0,-Math.pow(n,i.re))}}if(e===0&&n===0&&i.re>0&&i.im>=0)return o.ZERO;var h=Math.atan2(n,e),w=x(e,n);return e=Math.exp(i.re*w-i.im*h),n=i.im*w+i.re*h,new o(e*Math.cos(n),e*Math.sin(n))},sqrt:function(){var e=this.re,n=this.im,i=this.abs(),h,w;if(e>=0){if(n===0)return new o(Math.sqrt(e),0);h=.5*Math.sqrt(2*(i+e))}else h=Math.abs(n)/Math.sqrt(2*(i-e));return e<=0?w=.5*Math.sqrt(2*(i-e)):w=Math.abs(n)/Math.sqrt(2*(i+e)),new o(h,n<0?-w:w)},exp:function(){var e=Math.exp(this.re);return this.im,new o(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,n=this.im;return new o(Math.expm1(e)*Math.cos(n)+c(n),Math.exp(e)*Math.sin(n))},log:function(){var e=this.re,n=this.im;return new o(x(e,n),Math.atan2(n,e))},abs:function(){return d(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,n=this.im;return new o(Math.sin(e)*s(n),Math.cos(e)*u(n))},cos:function(){var e=this.re,n=this.im;return new o(Math.cos(e)*s(n),-Math.sin(e)*u(n))},tan:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)+s(n);return new o(Math.sin(e)/i,u(n)/i)},cot:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)-s(n);return new o(-Math.sin(e)/i,u(n)/i)},sec:function(){var e=this.re,n=this.im,i=.5*s(2*n)+.5*Math.cos(2*e);return new o(Math.cos(e)*s(n)/i,Math.sin(e)*u(n)/i)},csc:function(){var e=this.re,n=this.im,i=.5*s(2*n)-.5*Math.cos(2*e);return new o(Math.sin(e)*s(n)/i,-Math.cos(e)*u(n)/i)},asin:function(){var e=this.re,n=this.im,i=new o(n*n-e*e+1,-2*e*n).sqrt(),h=new o(i.re-n,i.im+e).log();return new o(h.im,-h.re)},acos:function(){var e=this.re,n=this.im,i=new o(n*n-e*e+1,-2*e*n).sqrt(),h=new o(i.re-n,i.im+e).log();return new o(Math.PI/2-h.im,h.re)},atan:function(){var e=this.re,n=this.im;if(e===0){if(n===1)return new o(0,1/0);if(n===-1)return new o(0,-1/0)}var i=e*e+(1-n)*(1-n),h=new o((1-n*n-e*e)/i,-2*e/i).log();return new o(-.5*h.im,.5*h.re)},acot:function(){var e=this.re,n=this.im;if(n===0)return new o(Math.atan2(1,e),0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).atan():new o(e!==0?e/0:0,n!==0?-n/0:0).atan()},asec:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new o(0,1/0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).acos():new o(e!==0?e/0:0,n!==0?-n/0:0).acos()},acsc:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new o(Math.PI/2,1/0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).asin():new o(e!==0?e/0:0,n!==0?-n/0:0).asin()},sinh:function(){var e=this.re,n=this.im;return new o(u(e)*Math.cos(n),s(e)*Math.sin(n))},cosh:function(){var e=this.re,n=this.im;return new o(s(e)*Math.cos(n),u(e)*Math.sin(n))},tanh:function(){var e=2*this.re,n=2*this.im,i=s(e)+Math.cos(n);return new o(u(e)/i,Math.sin(n)/i)},coth:function(){var e=2*this.re,n=2*this.im,i=s(e)-Math.cos(n);return new o(u(e)/i,-Math.sin(n)/i)},csch:function(){var e=this.re,n=this.im,i=Math.cos(2*n)-s(2*e);return new o(-2*u(e)*Math.cos(n)/i,2*s(e)*Math.sin(n)/i)},sech:function(){var e=this.re,n=this.im,i=Math.cos(2*n)+s(2*e);return new o(2*s(e)*Math.cos(n)/i,-2*u(e)*Math.sin(n)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var n=this.asin();return this.re=-this.im,this.im=e,e=n.re,n.re=-n.im,n.im=e,n},acosh:function(){var e=this.acos();if(e.im<=0){var n=e.re;e.re=-e.im,e.im=n}else{var n=e.im;e.im=-e.re,e.re=n}return e},atanh:function(){var e=this.re,n=this.im,i=e>1&&n===0,h=1-e,w=1+e,v=h*h+n*n,m=v!==0?new o((w*h-n*n)/v,(n*h+w*n)/v):new o(e!==-1?e/0:0,n!==0?n/0:0),N=m.re;return m.re=x(m.re,m.im)/2,m.im=Math.atan2(m.im,N)/2,i&&(m.im=-m.im),m},acoth:function(){var e=this.re,n=this.im;if(e===0&&n===0)return new o(0,Math.PI/2);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).atanh():new o(e!==0?e/0:0,n!==0?-n/0:0).atanh()},acsch:function(){var e=this.re,n=this.im;if(n===0)return new o(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var i=e*e+n*n;return i!==0?new o(e/i,-n/i).asinh():new o(e!==0?e/0:0,n!==0?-n/0:0).asinh()},asech:function(){var e=this.re,n=this.im;if(this.isZero())return o.INFINITY;var i=e*e+n*n;return i!==0?new o(e/i,-n/i).acosh():new o(e!==0?e/0:0,n!==0?-n/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var e=this.re,n=this.im,i=e*e+n*n;return new o(e/i,-n/i)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new o(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new o(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new o(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,n){var i=new o(e,n);return Math.abs(i.re-this.re)<=o.EPSILON&&Math.abs(i.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var e=this.re,n=this.im,i="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<o.EPSILON&&(e=0),Math.abs(n)<o.EPSILON&&(n=0),n===0?i+e:(e!==0?(i+=e,i+=" ",n<0?(n=-n,i+="-"):i+="+",i+=" "):n<0&&(n=-n,i+="-"),n!==1&&(i+=n),i+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,t.exports=o})()})(f);var I={},l={};Object.defineProperty(l,"__esModule",{value:!0});l.polarToRectangular=l.makeBoundedLinear=ae=l.makeLinear=Y=l.sum=l.countMap=se=l.initializedArray=l.count=j=l.zip=l.FIGURE_SPACE=l.NON_BREAKING_SPACE=l.dateIsValid=l.MIN_DATE=l.MAX_DATE=re=l.makePromise=l.filterMap=l.pick=l.pickAny=l.csvStringToArray=l.parseTimeT=l.parseIntX=l.parseFloatX=l.getAttribute=l.followPath=l.parseXml=l.testXml=Q=l.sleep=l.assertClass=void 0;function we(t,r,a="Assertion Failed."){const s=u=>{throw new Error(`${a}  Expected type:  ${r.name}.  Found type:  ${u}.`)};if(t===null)s("null");else if(typeof t!="object")s(typeof t);else if(!(t instanceof r))s(t.constructor.name);else return t;throw new Error("wtf")}l.assertClass=we;function ve(t){return new Promise(r=>setTimeout(r,t))}var Q=l.sleep=ve;function J(t){const a=new DOMParser().parseFromString(t,"application/xml");for(const s of Array.from(a.querySelectorAll("parsererror")))if(s instanceof HTMLElement)return{error:s};return{parsed:a}}l.testXml=J;function Me(t){if(t!==void 0)return J(t)?.parsed?.documentElement}l.parseXml=Me;function ee(t,...r){for(const a of r){if(t===void 0)return;if(typeof a=="number")t=t.children[a];else{const s=t.getElementsByTagName(a);if(s.length!=1)return;t=s[0]}}return t}l.followPath=ee;function be(t,r,...a){if(r=ee(r,...a),r!==void 0&&!!r.hasAttribute(t))return r.getAttribute(t)??void 0}l.getAttribute=be;function te(t){if(t==null)return;const r=parseFloat(t);if(isFinite(r))return r}l.parseFloatX=te;function ne(t){const r=te(t);if(r!==void 0)return r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER||r!=Math.floor(r)?void 0:r}l.parseIntX=ne;function ge(t){if(typeof t=="string"&&(t=ne(t)),t!=null&&!(t<=0))return new Date(t*1e3)}l.parseTimeT=ge;const xe=t=>{const r=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,a=[[]];let s;for(;s=r.exec(t);)s[1].length&&s[1]!==","&&a.push([]),a[a.length-1].push(s[2]!==void 0?s[2].replace(/""/g,'"'):s[3]);return a};l.csvStringToArray=xe;function Ee(t){const r=t.values().next();if(!r.done)return r.value}l.pickAny=Ee;function Ie(t){return t[Math.random()*t.length|0]}l.pick=Ie;function Ne(t,r){const a=[];return t.forEach((s,u)=>{const c=r(s,u);c!==void 0&&a.push(c)}),a}l.filterMap=Ne;function ye(){let t,r;return{promise:new Promise((s,u)=>{t=s,r=u}),resolve:t,reject:r}}var re=l.makePromise=ye;l.MAX_DATE=new Date(864e13);l.MIN_DATE=new Date(-864e13);function Ce(t){return isFinite(t.getTime())}l.dateIsValid=Ce;l.NON_BREAKING_SPACE="\xA0";l.FIGURE_SPACE="\u2007";function*Le(...t){const r=t.map(a=>a[Symbol.iterator]());for(;;){const a=r.map(s=>s.next());if(a.some(({done:s})=>s))break;yield a.map(({value:s})=>s)}}var j=l.zip=Le;function*Te(t=0,r=1/0,a=1){for(let s=t;s<r;s+=a)yield s}l.count=Te;function ie(t,r){const a=[];for(let s=0;s<t;s++)a.push(r(s));return a}var se=l.initializedArray=ie;l.countMap=ie;function Pe(t){return t.reduce((r,a)=>r+a,0)}var Y=l.sum=Pe;function Se(t,r,a,s){const u=(s-r)/(a-t);return function(c){return(c-t)*u+r}}var ae=l.makeLinear=Se;function ke(t,r,a,s){a<t&&([t,r,a,s]=[a,s,t,r]);const u=(s-r)/(a-t);return function(c){return c<=t?r:c>=a?s:(c-t)*u+r}}l.makeBoundedLinear=ke;function Ae(t,r){return{x:Math.sin(r)*t,y:Math.cos(r)*t}}l.polarToRectangular=Ae;Object.defineProperty(I,"__esModule",{value:!0});I.createElementFromHTML=I.getHashInfo=I.getAudioBalanceControl=I.getBlobFromCanvas=I.loadDateTimeLocal=b=I.getById=void 0;const oe=l;function Fe(t,r){const a=document.getElementById(t);if(!a)throw new Error("Could not find element with id "+t+".  Expected type:  "+r.name);if(a instanceof r)return a;throw new Error("Element with id "+t+" has type "+a.constructor.name+".  Expected type:  "+r.name)}var b=I.getById=Fe;function Ve(t,r,a="milliseconds"){let s;switch(a){case"minutes":{s=r.getSeconds()*1e3+r.getMilliseconds();break}case"seconds":{s=r.getMilliseconds();break}case"milliseconds":{s=0;break}default:throw new Error("wtf")}t.valueAsNumber=+r-r.getTimezoneOffset()*6e4-s}I.loadDateTimeLocal=Ve;function De(t){const{reject:r,resolve:a,promise:s}=(0,oe.makePromise)();return t.toBlob(u=>{u?a(u):r(new Error("blob is null!"))}),s}I.getBlobFromCanvas=De;function Be(t){const r=new AudioContext,a=r.createMediaElementSource(t),s=new StereoPannerNode(r,{pan:0});return a.connect(s).connect(r.destination),u=>{s.pan.value=u}}I.getAudioBalanceControl=Be;function Oe(){const t=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(s=>{const u=s.split("=",2);if(u.length==2){const c=decodeURIComponent(u[0]),d=decodeURIComponent(u[1]);t.set(c,d)}}),t}I.getHashInfo=Oe;function Re(t,r){var a=document.createElement("div");return a.innerHTML=t.trim(),(0,oe.assertClass)(a.firstChild,r,"createElementFromHTML:")}I.createElementFromHTML=Re;function*ue(t,r=[]){if(t.length==0)yield r;else for(let a=0;a<t.length;a++){const s=t[a],u=[...r,s],c=[...t.slice(0,a),...t.slice(a+1)];yield*ue(c,u)}}function $(t,r){if(!(r instanceof Array))return t;if(t.length!=r.length)throw new Error("wtf");let a=1/0,s;for(const u of ue(t)){let c=0;for(const[d,p]of j(u,r))c+=d.sub(p).abs();c<a&&(a=c,s=u)}return s}const _=new f.exports.Complex(1),P={shortName:"Square Root",allWs(t,r){const a=t.sqrt(),s=[a,a.neg()];return $(s,r)},error(t,r){return t.pow(2).sub(r).abs()},branchPoints:[f.exports.Complex.ZERO],initialZ:new f.exports.Complex(4),showSimpleCut:!0},_e={shortName:"Natural Log",allWs(t,r){function a(u,c){return u.add(0,c)}const s=t.log();return r?r.map(u=>{const c=u.im-s.im,d=Math.round(c/(Math.PI*2))*Math.PI*2;return a(s,d)}):[a(s,Math.PI*4),a(s,Math.PI*2),s,a(s,-Math.PI*2),a(s,-Math.PI*4)]},error(t,r){return t.exp().sub(r).abs()},branchPoints:[f.exports.Complex.ZERO],initialZ:f.exports.Complex.E,showSimpleCut:!0},qe={shortName:"\u{1D498}\xB3-\u{1D49B}\u{1D498}-2 = 0",initialZ:f.exports.Complex.ZERO,branchPoints:[new f.exports.Complex(3),new f.exports.Complex({r:3,phi:Math.PI*2/3}),new f.exports.Complex({r:3,phi:Math.PI*4/3})],allWs(t,r){const a=_.sub(t.pow(3).div(27)).sqrt(),s=t.isZero()?_:t.div(t.pow(3).pow(1/3)),u=_.add(a).pow(1/3),c=s.mul(_.sub(a).pow(1/3)),d=u.add(c),p=u.sub(c).mul(0,.866025403785),x=u.add(c).mul(-.5),B=x.add(p),o=x.sub(p);return $([d,B,o],r)},error(t,r){return t.pow(3).sub(r.mul(t)).sub(2).abs()},showSimpleCut:!1},O=[P,_e,qe],Z=b("formula",HTMLSelectElement);O.forEach(t=>{const r=document.createElement("option");r.innerText=t.shortName,Z.appendChild(r)});const ce=b("bottom",SVGGElement),le=b("main",SVGGElement),q=b("top",SVGGElement),he=b("positionInfo",HTMLDivElement),Ze=b("errorInfo",HTMLDivElement),W=new Intl.NumberFormat("en-US",{minimumSignificantDigits:4,maximumSignificantDigits:4});function He(t){const r=t.re,a=t.im;let s="";return(r|0)==r?s+=r:s+=W.format(r),a!=0&&(a>0&&(s+="+"),(a|0)==a?s+=a:s+=W.format(a),s+="\u{1D4F2}"),s}class M{static#t=Array.from(document.querySelectorAll("button, select"));static#e;static now(){if(this.#e)throw new Error("Already disabled.");const r=[];this.#t.forEach(a=>{a.disabled||(a.disabled=!0,r.push(a))}),this.#e=r,X()}static restore(){if(!this.#e)throw new Error("Already disabled.");this.#e.forEach(r=>r.disabled=!1),this.#e=void 0,X()}static isEnabled(){return this.#e==null}static isDisabled(){return this.#e!=null}}class U{constructor(r,a){this.color=r,this.#n=a,this.#r=a;const s=document.createElement("div");s.style.color=r,he.appendChild(s),this.#i=s,this.displayValue();const u=a.re,c=-a.im,d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.cx.baseVal.value=u,d.cy.baseVal.value=c,d.r.baseVal.value=.2,d.style.setProperty("--base-color",r),q.appendChild(d),this.#t=d;const p=document.createElementNS("http://www.w3.org/2000/svg","rect"),x=.5;p.x.baseVal.value=u-x/2,p.y.baseVal.value=c-x/2,p.width.baseVal.value=x,p.height.baseVal.value=x,p.style.setProperty("--base-color",r),ce.appendChild(p),this.newLine()}#t;#e;get lastSegment(){return this.#e}#n;get currentValue(){return this.#n}set currentValue(r){const a=r.re,s=-r.im,u=this.#e;u.x2.baseVal.value=a,u.y2.baseVal.value=s;const c=this.#t;c.cx.baseVal.value=a,c.cy.baseVal.value=s,this.#n=r,this.displayValue()}#r;undo(){this.currentValue=this.#r}get lastSaved(){return this.#r}#i;displayValue(){this.#i.innerText=He(this.#n)}newLine(){const r=this.#n,a=r.re,s=-r.im,u=document.createElementNS("http://www.w3.org/2000/svg","line");u.x1.baseVal.value=a,u.y1.baseVal.value=s,u.x2.baseVal.value=a,u.y2.baseVal.value=s,u.setAttribute("stroke",this.color),u.classList.add("active"),this.#e?.classList?.remove("active"),le.appendChild(u),this.#e=u,this.#r=r}save(){this.#n.equals(this.#r)||(this.#e&&this.#e.classList.add("can-be-styled"),this.newLine())}}let y,C,V,L;const T=b("showCut",HTMLInputElement);function X(){T.disabled=M.isDisabled()||!y.showSimpleCut}function fe(){L&&(L.style.display=T.checked?"":"none")}T.addEventListener("click",()=>{fe()});function me(){if(L){const t=15*Math.SQRT2,a=y.branchPoints[0].sub(C.lastSaved).arg(),s=new f.exports.Complex({r:t,phi:a});L.x2.baseVal.value=s.re,L.y2.baseVal.value=-s.im}}function F(t){ce.innerHTML="",le.innerHTML="",q.innerHTML="",L=void 0,he.innerHTML="",t?(y=t,Z.selectedIndex=O.indexOf(t)):y=O[Z.selectedIndex];const r=y.initialZ;C=new U("black",r);const a=y.allWs(r);if(V=a.map((s,u)=>{const c=`hsl(${u/a.length}turn, 100%, 50%)`;return new U(c,s)}),y.showSimpleCut){L=document.createElementNS("http://www.w3.org/2000/svg","line"),L.classList.add("cut-ray");const s=y.branchPoints[0];L.x1.baseVal.value=s.re,L.y1.baseVal.value=-s.im,me(),fe(),q.appendChild(L)}X(),de();for(const s of y.branchPoints){const u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.classList.add("branch-point"),u.cx.baseVal.value=s.re,u.cy.baseVal.value=-s.im,u.r.baseVal.value=.1,q.appendChild(u)}}F();Z.addEventListener("change",()=>{F()});b("reset",HTMLButtonElement).addEventListener("click",()=>F(y));function de(){const t=C.currentValue,r=Y(V.map(a=>y.error(a.currentValue,t)));Ze.innerText=`Total error = ${r}`}function k(t){C.currentValue=t;for(const[r,a]of j(y.allWs(t,V.map(s=>s.lastSaved)),V))a.currentValue=r;de()}const D=document.querySelector("svg"),G=D.createSVGPoint();function ze(t){G.x=t.clientX,G.y=t.clientY;const r=G.matrixTransform(D.getScreenCTM().inverse());return new f.exports.Complex(r.x,-r.y)}function R(){C.save(),me(),V.forEach(t=>t.save())}D.addEventListener("mouseleave",()=>{M.isDisabled()||(C.undo(),V.forEach(t=>t.undo()))});D.addEventListener("mousemove",t=>{M.isDisabled()||(k(ze(t)),t.buttons&1&&R())});D.addEventListener("mouseup",t=>{M.isDisabled()||R()});function S(t){switch(typeof t){case"number":{const r=O[t];if(!r)throw new Error(`No such formula: ${t}`);F(r);break}case"object":{F(t);break}case"string":{const r=O.find(a=>a.shortName==t);if(!r)throw new Error(`No such formula: "${t}"`);F(r);break}}}function pe(t){return new f.exports.Complex({r:1,phi:t})}function H(t){return pe(t*(Math.PI*2))}function K(t){return pe(t*(Math.PI/180))}const Ge={shortName:"Sixth Root",allWs(t,r){const s=t.pow(.16666666666666666),u=se(6,c=>s.mul(H(c/6)));return $(u,r)},error(t,r){return t.pow(6).sub(r).abs()},branchPoints:[f.exports.Complex.ZERO],initialZ:new f.exports.Complex(6),showSimpleCut:!0};class z{constructor(r,a,s){this.center=r,this.steps=s,this.#t=a.sub(r)}#t;#e=0;getPosition(r){return r==1&&(r=0),this.#t.mul(H(r)).add(this.center)}updateNow(r){const a=this.steps*r|0;for(;this.#e<a;)this.#e++,k(this.getPosition(this.#e/this.steps)),R();k(this.getPosition(r))}}function g(t,r){const a=re(),s=performance.now(),u=s+t,c=ae(s,0,u,1);let d=s;function p(x){try{x>=u?(r.updateNow(1),a.resolve()):(x>d&&r.updateNow(c(x)),requestAnimationFrame(p))}catch(B){a.reject(B)}}return requestAnimationFrame(p),a.promise}class E{constructor(r,a,s){this.to=a,this.steps=s,this.#e=a.sub(r)}#t=0;#e;getPosition(r){return this.to.sub(this.#e.mul(1-r))}updateNow(r){if(this.steps){const a=this.steps*r|0;for(;this.#t<a;)this.#t++,k(this.getPosition(this.#t/this.steps)),R()}k(this.getPosition(r))}static makeDiamond(r,a=C.lastSaved){const s=[];for(let u=0;u<4;u++){const c=Xe(a);s.push(new this(a,c,r)),a=c}return s}}function Xe(t){return new f.exports.Complex({re:-t.im,im:t.re})}function A(t){Array.from(D.querySelectorAll(".can-be-styled")).forEach(r=>{const a=r.classList;a.remove("can-be-styled"),a.add(t)})}["thin","fat"].forEach(t=>{b(t,HTMLButtonElement).addEventListener("click",()=>{A(t)})});b("showMeCirclesAndRoots",HTMLButtonElement).addEventListener("click",async()=>{M.now(),T.checked=!1,S(P),await g(5e3,new z(f.exports.Complex.ZERO,C.lastSaved,20)),A("fat"),await Q(500),await g(5e3,new z(f.exports.Complex.ZERO,C.lastSaved,20)),M.restore()});b("showMeBranchCuts1",HTMLButtonElement).addEventListener("click",async()=>{M.now(),T.checked=!0,S(P);let t=C.currentValue;const r=[[500,new f.exports.Complex(1,1)],[750,new f.exports.Complex(1,-1)],[750,new f.exports.Complex(1,1)],[750,new f.exports.Complex(1,-1)],[750,new f.exports.Complex(1,1)],[500,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[500,new f.exports.Complex(1,1)],[500,new f.exports.Complex(1,-1)],[500,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)]];for(const[a,s]of r)await g(a,new E(t,s,0)),t=s;M.restore()});b("showMeBranchCuts2",HTMLButtonElement).addEventListener("click",async()=>{M.now(),T.checked=!0,S(P);let t=new f.exports.Complex(-2,-2);k(t),R();const r=[[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)],[750,new f.exports.Complex(-2,2)],[750,new f.exports.Complex(-2,-2)]];for(const[a,s]of r)await g(a,new E(t,s,5)),t=s;A("thin"),await g(5e3,new z(f.exports.Complex.ZERO,t,7)),A("fat"),await g(5e3,new z(f.exports.Complex.ZERO,t,35)),M.restore()});b("showMeSquare1",HTMLButtonElement).addEventListener("click",async()=>{M.now(),T.checked=!1,S(P);for(const t of E.makeDiamond(1))await g(1500,t);M.restore()});b("showMeSquare2",HTMLButtonElement).addEventListener("click",async()=>{M.now(),T.checked=!1,S(P);for(const t of E.makeDiamond(1))t.updateNow(1);A("thin");for(const t of E.makeDiamond(2))await g(1500,t);M.restore()});b("showMeSquare3",HTMLButtonElement).addEventListener("click",async()=>{M.now(),T.checked=!1,S(P);for(const t of E.makeDiamond(1))t.updateNow(1);A("thin");for(const t of E.makeDiamond(2))t.updateNow(1);A("fat");for(const t of E.makeDiamond(30))await g(1500,t);M.restore()});b("showMeEquilateralTriangle",HTMLButtonElement).addEventListener("click",async()=>{const t=new f.exports.Complex(6.5),r=t.mul(H(1/3)),a=t.mul(H(2/3));M.now(),T.checked=!1,S(P),await g(250,new E(C.currentValue,t,1)),await g(2e3,new E(t,r,50)),await g(2e3,new E(r,a,50)),await g(2e3,new E(a,t,50)),M.restore()});b("showMeRightTriangle",HTMLButtonElement).addEventListener("click",async()=>{const r=6*Math.sqrt(3),a=2*6;M.now(),T.checked=!1,S(P);const s=C.lastSaved,u=s.add(K(90+45+20).mul(r)),c=s.add(K(180+45+20).mul(6)),d=6e3,p=Y([6,r,a]);await g(d*r/p,new E(s,u,50)),await g(d*a/p,new E(u,c,50)),await g(d*6/p,new E(c,s,50)),M.restore()});window.phil={updateZ(t,r){k(new f.exports.Complex(t,r))},selectFormula:S,sixthRootFormula:Ge,DisableUserInterface:M};
