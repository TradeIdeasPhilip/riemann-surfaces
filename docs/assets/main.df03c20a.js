(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const l of u)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function s(u){const l={};return u.integrity&&(l.integrity=u.integrity),u.referrerpolicy&&(l.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?l.credentials="include":u.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(u){if(u.ep)return;u.ep=!0;const l=s(u);fetch(u.href,l)}})();var w={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(n,i){(function(s){var a=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:(Math.exp(e)+Math.exp(-e))*.5},u=Math.sinh||function(e){return Math.abs(e)<1e-9?e:(Math.exp(e)-Math.exp(-e))*.5},l=function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var r=e*e;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},m=function(e,t){var r=Math.abs(e),h=Math.abs(t);return r<3e3&&h<3e3?Math.sqrt(r*r+h*h):(r<h?(r=h,h=e/t):h=t/e,r*Math.sqrt(1+h*h))},p=function(){throw SyntaxError("Invalid Param")};function M(e,t){var r=Math.abs(e),h=Math.abs(t);return e===0?Math.log(h):t===0?Math.log(r):r<3e3&&h<3e3?Math.log(e*e+t*t)*.5:(e=e/2,t=t/2,.5*Math.log(e*e+t*t)+Math.LN2)}var L=function(e,t){var r={re:0,im:0};if(e==null)r.re=r.im=0;else if(t!==void 0)r.re=e,r.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)r.re=e.re,r.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return o.INFINITY;r.re=e.abs*Math.cos(e.arg),r.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return o.INFINITY;r.re=e.r*Math.cos(e.phi),r.im=e.r*Math.sin(e.phi)}else e.length===2?(r.re=e[0],r.im=e[1]):p();break;case"string":r.im=r.re=0;var h=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),d=1,v=0;h===null&&p();for(var f=0;f<h.length;f++){var I=h[f];I===" "||I==="	"||I===`
`||(I==="+"?d++:I==="-"?v++:I==="i"||I==="I"?(d+v===0&&p(),h[f+1]!==" "&&!isNaN(h[f+1])?(r.im+=parseFloat((v%2?"-":"")+h[f+1]),f++):r.im+=parseFloat((v%2?"-":"")+"1"),d=v=0):((d+v===0||isNaN(I))&&p(),h[f+1]==="i"||h[f+1]==="I"?(r.im+=parseFloat((v%2?"-":"")+I),f++):r.re+=parseFloat((v%2?"-":"")+I),d=v=0))}d+v>0&&p();break;case"number":r.im=0,r.re=e;break;default:p()}return isNaN(r.re)||isNaN(r.im),r};function o(e,t){if(!(this instanceof o))return new o(e,t);var r=L(e,t);this.re=r.re,this.im=r.im}o.prototype={re:0,im:0,sign:function(){var e=this.abs();return new o(this.re/e,this.im/e)},add:function(e,t){var r=new o(e,t);return this.isInfinite()&&r.isInfinite()?o.NAN:this.isInfinite()||r.isInfinite()?o.INFINITY:new o(this.re+r.re,this.im+r.im)},sub:function(e,t){var r=new o(e,t);return this.isInfinite()&&r.isInfinite()?o.NAN:this.isInfinite()||r.isInfinite()?o.INFINITY:new o(this.re-r.re,this.im-r.im)},mul:function(e,t){var r=new o(e,t);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?o.NAN:this.isInfinite()||r.isInfinite()?o.INFINITY:r.im===0&&this.im===0?new o(this.re*r.re,0):new o(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(e,t){var r=new o(e,t);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return o.NAN;if(this.isInfinite()||r.isZero())return o.INFINITY;if(this.isZero()||r.isInfinite())return o.ZERO;e=this.re,t=this.im;var h=r.re,d=r.im,v,f;return d===0?new o(e/h,t/h):Math.abs(h)<Math.abs(d)?(f=h/d,v=h*f+d,new o((e*f+t)/v,(t*f-e)/v)):(f=d/h,v=d*f+h,new o((e+t*f)/v,(t-e*f)/v))},pow:function(e,t){var r=new o(e,t);if(e=this.re,t=this.im,r.isZero())return o.ONE;if(r.im===0){if(t===0&&e>0)return new o(Math.pow(e,r.re),0);if(e===0)switch((r.re%4+4)%4){case 0:return new o(Math.pow(t,r.re),0);case 1:return new o(0,Math.pow(t,r.re));case 2:return new o(-Math.pow(t,r.re),0);case 3:return new o(0,-Math.pow(t,r.re))}}if(e===0&&t===0&&r.re>0&&r.im>=0)return o.ZERO;var h=Math.atan2(t,e),d=M(e,t);return e=Math.exp(r.re*d-r.im*h),t=r.im*d+r.re*h,new o(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e=this.re,t=this.im,r=this.abs(),h,d;if(e>=0){if(t===0)return new o(Math.sqrt(e),0);h=.5*Math.sqrt(2*(r+e))}else h=Math.abs(t)/Math.sqrt(2*(r-e));return e<=0?d=.5*Math.sqrt(2*(r-e)):d=Math.abs(t)/Math.sqrt(2*(r+e)),new o(h,t<0?-d:d)},exp:function(){var e=Math.exp(this.re);return this.im,new o(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new o(Math.expm1(e)*Math.cos(t)+l(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return new o(M(e,t),Math.atan2(t,e))},abs:function(){return m(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new o(Math.sin(e)*a(t),Math.cos(e)*u(t))},cos:function(){var e=this.re,t=this.im;return new o(Math.cos(e)*a(t),-Math.sin(e)*u(t))},tan:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)+a(t);return new o(Math.sin(e)/r,u(t)/r)},cot:function(){var e=2*this.re,t=2*this.im,r=Math.cos(e)-a(t);return new o(-Math.sin(e)/r,u(t)/r)},sec:function(){var e=this.re,t=this.im,r=.5*a(2*t)+.5*Math.cos(2*e);return new o(Math.cos(e)*a(t)/r,Math.sin(e)*u(t)/r)},csc:function(){var e=this.re,t=this.im,r=.5*a(2*t)-.5*Math.cos(2*e);return new o(Math.sin(e)*a(t)/r,-Math.cos(e)*u(t)/r)},asin:function(){var e=this.re,t=this.im,r=new o(t*t-e*e+1,-2*e*t).sqrt(),h=new o(r.re-t,r.im+e).log();return new o(h.im,-h.re)},acos:function(){var e=this.re,t=this.im,r=new o(t*t-e*e+1,-2*e*t).sqrt(),h=new o(r.re-t,r.im+e).log();return new o(Math.PI/2-h.im,h.re)},atan:function(){var e=this.re,t=this.im;if(e===0){if(t===1)return new o(0,1/0);if(t===-1)return new o(0,-1/0)}var r=e*e+(1-t)*(1-t),h=new o((1-t*t-e*e)/r,-2*e/r).log();return new o(-.5*h.im,.5*h.re)},acot:function(){var e=this.re,t=this.im;if(t===0)return new o(Math.atan2(1,e),0);var r=e*e+t*t;return r!==0?new o(e/r,-t/r).atan():new o(e!==0?e/0:0,t!==0?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new o(0,1/0);var r=e*e+t*t;return r!==0?new o(e/r,-t/r).acos():new o(e!==0?e/0:0,t!==0?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new o(Math.PI/2,1/0);var r=e*e+t*t;return r!==0?new o(e/r,-t/r).asin():new o(e!==0?e/0:0,t!==0?-t/0:0).asin()},sinh:function(){var e=this.re,t=this.im;return new o(u(e)*Math.cos(t),a(e)*Math.sin(t))},cosh:function(){var e=this.re,t=this.im;return new o(a(e)*Math.cos(t),u(e)*Math.sin(t))},tanh:function(){var e=2*this.re,t=2*this.im,r=a(e)+Math.cos(t);return new o(u(e)/r,Math.sin(t)/r)},coth:function(){var e=2*this.re,t=2*this.im,r=a(e)-Math.cos(t);return new o(u(e)/r,-Math.sin(t)/r)},csch:function(){var e=this.re,t=this.im,r=Math.cos(2*t)-a(2*e);return new o(-2*u(e)*Math.cos(t)/r,2*a(e)*Math.sin(t)/r)},sech:function(){var e=this.re,t=this.im,r=Math.cos(2*t)+a(2*e);return new o(2*a(e)*Math.cos(t)/r,-2*u(e)*Math.sin(t)/r)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else{var t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){var e=this.re,t=this.im,r=e>1&&t===0,h=1-e,d=1+e,v=h*h+t*t,f=v!==0?new o((d*h-t*t)/v,(t*h+d*t)/v):new o(e!==-1?e/0:0,t!==0?t/0:0),I=f.re;return f.re=M(f.re,f.im)/2,f.im=Math.atan2(f.im,I)/2,r&&(f.im=-f.im),f},acoth:function(){var e=this.re,t=this.im;if(e===0&&t===0)return new o(0,Math.PI/2);var r=e*e+t*t;return r!==0?new o(e/r,-t/r).atanh():new o(e!==0?e/0:0,t!==0?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(t===0)return new o(e!==0?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var r=e*e+t*t;return r!==0?new o(e/r,-t/r).asinh():new o(e!==0?e/0:0,t!==0?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return o.INFINITY;var r=e*e+t*t;return r!==0?new o(e/r,-t/r).acosh():new o(e!==0?e/0:0,t!==0?-t/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var e=this.re,t=this.im,r=e*e+t*t;return new o(e/r,-t/r)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new o(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new o(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new o(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var r=new o(e,t);return Math.abs(r.re-this.re)<=o.EPSILON&&Math.abs(r.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var e=this.re,t=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<o.EPSILON&&(e=0),Math.abs(t)<o.EPSILON&&(t=0),t===0?r+e:(e!==0?(r+=e,r+=" ",t<0?(t=-t,r+="-"):r+="+",r+=" "):t<0&&(t=-t,r+="-"),t!==1&&(r+=t),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,n.exports=o})()})(w);var b={},c={};Object.defineProperty(c,"__esModule",{value:!0});c.polarToRectangular=c.makeBoundedLinear=c.makeLinear=K=c.sum=c.countMap=k=c.initializedArray=W=c.count=_=c.zip=c.FIGURE_SPACE=c.NON_BREAKING_SPACE=c.dateIsValid=c.MIN_DATE=c.MAX_DATE=c.makePromise=c.filterMap=c.pick=c.pickAny=c.csvStringToArray=c.parseTimeT=c.parseIntX=c.parseFloatX=c.getAttribute=c.followPath=c.parseXml=c.testXml=g=c.sleep=c.assertClass=void 0;function ie(n,i,s="Assertion Failed."){const a=u=>{throw new Error(`${s}  Expected type:  ${i.name}.  Found type:  ${u}.`)};if(n===null)a("null");else if(typeof n!="object")a(typeof n);else if(!(n instanceof i))a(n.constructor.name);else return n;throw new Error("wtf")}c.assertClass=ie;function se(n){return new Promise(i=>setTimeout(i,n))}var g=c.sleep=se;function X(n){const s=new DOMParser().parseFromString(n,"application/xml");for(const a of Array.from(s.querySelectorAll("parsererror")))if(a instanceof HTMLElement)return{error:a};return{parsed:s}}c.testXml=X;function ae(n){if(n!==void 0)return X(n)?.parsed?.documentElement}c.parseXml=ae;function j(n,...i){for(const s of i){if(n===void 0)return;if(typeof s=="number")n=n.children[s];else{const a=n.getElementsByTagName(s);if(a.length!=1)return;n=a[0]}}return n}c.followPath=j;function oe(n,i,...s){if(i=j(i,...s),i!==void 0&&!!i.hasAttribute(n))return i.getAttribute(n)??void 0}c.getAttribute=oe;function Y(n){if(n==null)return;const i=parseFloat(n);if(isFinite(i))return i}c.parseFloatX=Y;function $(n){const i=Y(n);if(i!==void 0)return i>Number.MAX_SAFE_INTEGER||i<Number.MIN_SAFE_INTEGER||i!=Math.floor(i)?void 0:i}c.parseIntX=$;function ue(n){if(typeof n=="string"&&(n=$(n)),n!=null&&!(n<=0))return new Date(n*1e3)}c.parseTimeT=ue;const ce=n=>{const i=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,s=[[]];let a;for(;a=i.exec(n);)a[1].length&&a[1]!==","&&s.push([]),s[s.length-1].push(a[2]!==void 0?a[2].replace(/""/g,'"'):a[3]);return s};c.csvStringToArray=ce;function le(n){const i=n.values().next();if(!i.done)return i.value}c.pickAny=le;function he(n){return n[Math.random()*n.length|0]}c.pick=he;function fe(n,i){const s=[];return n.forEach((a,u)=>{const l=i(a,u);l!==void 0&&s.push(l)}),s}c.filterMap=fe;function me(){let n,i;return{promise:new Promise((a,u)=>{n=a,i=u}),resolve:n,reject:i}}c.makePromise=me;c.MAX_DATE=new Date(864e13);c.MIN_DATE=new Date(-864e13);function de(n){return isFinite(n.getTime())}c.dateIsValid=de;c.NON_BREAKING_SPACE="\xA0";c.FIGURE_SPACE="\u2007";function*pe(...n){const i=n.map(s=>s[Symbol.iterator]());for(;;){const s=i.map(a=>a.next());if(s.some(({done:a})=>a))break;yield s.map(({value:a})=>a)}}var _=c.zip=pe;function*ve(n=0,i=1/0,s=1){for(let a=n;a<i;a+=s)yield a}var W=c.count=ve;function U(n,i){const s=[];for(let a=0;a<n;a++)s.push(i(a));return s}var k=c.initializedArray=U;c.countMap=U;function we(n){return n.reduce((i,s)=>i+s,0)}var K=c.sum=we;function Me(n,i,s,a){const u=(a-i)/(s-n);return function(l){return(l-n)*u+i}}c.makeLinear=Me;function be(n,i,s,a){s<n&&([n,i,s,a]=[s,a,n,i]);const u=(a-i)/(s-n);return function(l){return l<=n?i:l>=s?a:(l-n)*u+i}}c.makeBoundedLinear=be;function Ie(n,i){return{x:Math.sin(i)*n,y:Math.cos(i)*n}}c.polarToRectangular=Ie;Object.defineProperty(b,"__esModule",{value:!0});b.createElementFromHTML=b.getHashInfo=b.getAudioBalanceControl=b.getBlobFromCanvas=b.loadDateTimeLocal=E=b.getById=void 0;const J=c;function ge(n,i){const s=document.getElementById(n);if(!s)throw new Error("Could not find element with id "+n+".  Expected type:  "+i.name);if(s instanceof i)return s;throw new Error("Element with id "+n+" has type "+s.constructor.name+".  Expected type:  "+i.name)}var E=b.getById=ge;function Ne(n,i,s="milliseconds"){let a;switch(s){case"minutes":{a=i.getSeconds()*1e3+i.getMilliseconds();break}case"seconds":{a=i.getMilliseconds();break}case"milliseconds":{a=0;break}default:throw new Error("wtf")}n.valueAsNumber=+i-i.getTimezoneOffset()*6e4-a}b.loadDateTimeLocal=Ne;function Ee(n){const{reject:i,resolve:s,promise:a}=(0,J.makePromise)();return n.toBlob(u=>{u?s(u):i(new Error("blob is null!"))}),a}b.getBlobFromCanvas=Ee;function ye(n){const i=new AudioContext,s=i.createMediaElementSource(n),a=new StereoPannerNode(i,{pan:0});return s.connect(a).connect(i.destination),u=>{a.pan.value=u}}b.getAudioBalanceControl=ye;function xe(){const n=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(a=>{const u=a.split("=",2);if(u.length==2){const l=decodeURIComponent(u[0]),m=decodeURIComponent(u[1]);n.set(l,m)}}),n}b.getHashInfo=xe;function Te(n,i){var s=document.createElement("div");return s.innerHTML=n.trim(),(0,J.assertClass)(s.firstChild,i,"createElementFromHTML:")}b.createElementFromHTML=Te;function*Q(n,i=[]){if(n.length==0)yield i;else for(let s=0;s<n.length;s++){const a=n[s],u=[...i,a],l=[...n.slice(0,s),...n.slice(s+1)];yield*Q(l,u)}}function q(n,i){if(!(i instanceof Array))return n;if(n.length!=i.length)throw new Error("wtf");let s=1/0,a;for(const u of Q(n)){let l=0;for(const[m,p]of _(u,i))l+=m.sub(p).abs();l<s&&(s=l,a=u)}return a}const A=new w.exports.Complex(1),R={shortName:"Square Root",allWs(n,i){const s=n.sqrt(),a=[s,s.neg()];return q(a,i)},error(n,i){return n.pow(2).sub(i).abs()},branchPoints:[w.exports.Complex.ZERO],initialZ:new w.exports.Complex(4)},Pe={shortName:"Natural Log",allWs(n,i){function s(u,l){return u.add(0,l)}const a=n.log();return i?i.map(u=>{const l=u.im-a.im,m=Math.round(l/(Math.PI*2))*Math.PI*2;return s(a,m)}):[s(a,Math.PI*4),s(a,Math.PI*2),a,s(a,-Math.PI*2),s(a,-Math.PI*4)]},error(n,i){return n.exp().sub(i).abs()},branchPoints:[w.exports.Complex.ZERO],initialZ:w.exports.Complex.E},Le={shortName:"\u{1D498}\xB3-\u{1D49B}\u{1D498}-2 = 0",initialZ:w.exports.Complex.ZERO,branchPoints:[new w.exports.Complex(3),new w.exports.Complex({r:3,phi:Math.PI*2/3}),new w.exports.Complex({r:3,phi:Math.PI*4/3})],allWs(n,i){const s=A.sub(n.pow(3).div(27)).sqrt(),a=n.isZero()?A:n.div(n.pow(3).pow(1/3)),u=A.add(s).pow(1/3),l=a.mul(A.sub(s).pow(1/3)),m=u.add(l),p=u.sub(l).mul(0,.866025403785),M=u.add(l).mul(-.5),L=M.add(p),o=M.sub(p);return q([m,L,o],i)},error(n,i){return n.pow(3).sub(i.mul(n)).sub(2).abs()}},S=[R,Pe,Le],O=E("formula",HTMLSelectElement);S.forEach(n=>{const i=document.createElement("option");i.innerText=n.shortName,O.appendChild(i)});const ee=E("bottom",SVGGElement),te=E("main",SVGGElement),B=E("top",SVGGElement),ne=E("positionInfo",HTMLDivElement),Ce=E("errorInfo",HTMLDivElement),z=new Intl.NumberFormat("en-US",{minimumSignificantDigits:4,maximumSignificantDigits:4});function Fe(n){const i=n.re,s=n.im;let a="";return(i|0)==i?a+=i:a+=z.format(i),s!=0&&(s>0&&(a+="+"),(s|0)==s?a+=s:a+=z.format(s),a+="\u{1D4F2}"),a}class H{constructor(i,s){this.color=i,this.#e=s,this.#t=s;const a=document.createElement("div");a.style.color=i,ne.appendChild(a),this.#i=a,this.displayValue();const u=s.re,l=-s.im,m=document.createElementNS("http://www.w3.org/2000/svg","circle");m.cx.baseVal.value=u,m.cy.baseVal.value=l,m.r.baseVal.value=.2,m.style.setProperty("--base-color",i),B.appendChild(m),this.#r=m;const p=document.createElementNS("http://www.w3.org/2000/svg","rect"),M=.5;p.x.baseVal.value=u-M/2,p.y.baseVal.value=l-M/2,p.width.baseVal.value=M,p.height.baseVal.value=M,p.style.setProperty("--base-color",i),ee.appendChild(p),this.newLine()}#r;#n;get lastSegment(){return this.#n}#e;get currentValue(){return this.#e}set currentValue(i){const s=i.re,a=-i.im,u=this.#n;u.x2.baseVal.value=s,u.y2.baseVal.value=a;const l=this.#r;l.cx.baseVal.value=s,l.cy.baseVal.value=a,this.#e=i,this.displayValue()}#t;undo(){this.currentValue=this.#t}get lastSaved(){return this.#t}#i;displayValue(){this.#i.innerText=Fe(this.#e)}newLine(){const i=this.#e,s=i.re,a=-i.im,u=document.createElementNS("http://www.w3.org/2000/svg","line");u.x1.baseVal.value=s,u.y1.baseVal.value=a,u.x2.baseVal.value=s,u.y2.baseVal.value=a,u.setAttribute("stroke",this.color),u.classList.add("active"),this.#n?.classList?.remove("active"),te.appendChild(u),this.#n=u,this.#t=i}save(){this.#e.equals(this.#t)||this.newLine()}}let y,N,x;function T(n){ee.innerHTML="",te.innerHTML="",B.innerHTML="",ne.innerHTML="",n?(y=n,O.selectedIndex=S.indexOf(n)):y=S[O.selectedIndex];const i=y.initialZ;N=new H("black",i);const s=y.allWs(i);x=s.map((a,u)=>{const l=`hsl(${u/s.length}turn, 100%, 50%)`;return new H(l,a)}),re();for(const a of y.branchPoints){const u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.classList.add("branch-point"),u.cx.baseVal.value=a.re,u.cy.baseVal.value=-a.im,u.r.baseVal.value=.1,B.appendChild(u)}}T();O.addEventListener("change",()=>{T()});E("reset",HTMLButtonElement).addEventListener("click",()=>T(y));function re(){const n=N.currentValue,i=K(x.map(s=>y.error(s.currentValue,n)));Ce.innerText=`Total error = ${i}`}function C(n){N.currentValue=n;for(const[i,s]of _(y.allWs(n,x.map(a=>a.lastSaved)),x))s.currentValue=i;re()}const P=document.querySelector("svg"),Z=P.createSVGPoint();function Se(n){Z.x=n.clientX,Z.y=n.clientY;const i=Z.matrixTransform(P.getScreenCTM().inverse());return new w.exports.Complex(i.x,-i.y)}function F(){N.save(),x.forEach(n=>n.save())}P.addEventListener("mouseleave",()=>{N.undo(),x.forEach(n=>n.undo())});P.addEventListener("mousemove",n=>{C(Se(n)),n.buttons&1&&F()});P.addEventListener("mouseup",n=>{F()});function D(n){switch(typeof n){case"number":{const i=S[n];if(!i)throw new Error(`No such formula: ${n}`);T(i);break}case"object":{T(n);break}case"string":{const i=S.find(s=>s.shortName==n);if(!i)throw new Error(`No such formula: "${n}"`);T(i);break}}}const Ae={shortName:"Sixth Root",allWs(n,i){const a=n.pow(.16666666666666666),u=k(6,l=>a.mul({r:1,phi:Math.PI*2/6*l}));return q(u,i)},error(n,i){return n.pow(6).sub(i).abs()},branchPoints:[w.exports.Complex.ZERO],initialZ:new w.exports.Complex(6)};function G(n,i,s){const a=i.sub(n),u=new w.exports.Complex({r:1,phi:2*Math.PI/s}),l=k(Math.abs(s)-1,m=>u.pow(m+1).mul(a).add(n));return l.push(i),l}function Ve(n,i,s){const a=i.sub(n);return k(s,u=>i.sub(a.mul((s-u-1)/s)))}function Oe(n){return new w.exports.Complex({re:-n.im,im:n.re})}function _e(){const n=new Set([N,...x].map(i=>i.lastSegment));return Array.from(P.querySelectorAll("line")).filter(i=>!n.has(i))}function V(n){_e().forEach(i=>{const s=i.classList;s.contains("thin")||s.contains("fat")||s.add(n)})}["thin","fat"].forEach(n=>{E(n,HTMLButtonElement).addEventListener("click",()=>{V(n)})});async function ke(){D(R),await g(100);const n=30;for(const s of G(w.exports.Complex.ZERO,N.lastSaved,n))C(s),await g(3e3/n),F();V("fat"),await g(500);for(const s of G(w.exports.Complex.ZERO,N.lastSaved,n))C(s),F(),await g(3e3/n);await g(2e3),D(R);async function i(s,a=Math.floor(50/s),u=3e3){const l=s*a;let m=N.lastSaved;for(let p=0;p<4;p++){const M=Oe(m);for(const[L,o]of _(Ve(m,M,l),W()))C(L),await g(u/l),(o+1)%a==0&&F();m=M}}await i(1),V("thin"),await g(500),await i(2),V("fat"),await g(500),await i(30),await g(500)}window.phil={updateZ(n,i){C(new w.exports.Complex(n,i))},selectFormula:D,sixthRootFormula:Ae,demo:ke};
